{"version":3,"file":"filebrowser.min.js.map","sources":["filebrowser.js"],"sourcesContent":["/**\n   Copyright 2024 Carlos A. (https://github.com/dealfonso)\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n*/\n\n(function (exports) {\n\tif (typeof exports === \"undefined\") {\n\t\texports = window;\n\t}\n\tclass FBDropdown {\n\t\tstatic defaults = {\n\t\t\tcloseOnOutsideClick: true,\n\t\t\topeningSide: \"auto\",\n\t\t\topeningSideToPage: false\n\t\t};\n\t\textractOptions() {\n\t\t\tlet options = {};\n\t\t\tfor (let key in FBDropdown.defaults) {\n\t\t\t\tif (this.dropdown.dataset[key] !== undefined) {\n\t\t\t\t\toptions[key] = this.dropdown.dataset[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\tconstructor(dropdown, options = {}) {\n\t\t\tif (dropdown._fbDropdown !== undefined) {\n\t\t\t\treturn dropdown._fbDropdown;\n\t\t\t}\n\t\t\tthis.dropdown = dropdown;\n\t\t\tlet effectiveOptions = Object.assign({}, FBDropdown.defaults, this.extractOptions(), options);\n\t\t\tthis.options = effectiveOptions;\n\t\t\tthis.toggle = dropdown.querySelector(\".fb-dropdown-toggle\");\n\t\t\tthis.content = dropdown.querySelector(\".fb-dropdown-content\");\n\t\t\tthis.isOpen = false;\n\t\t\tthis.documentClickHandler = !this.options.closeOnOutsideClick ? null : event => {\n\t\t\t\tif (!this.dropdown.contains(event.target)) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.optionsInMenu = dropdown.querySelectorAll(\".fb-dropdown-content\"),\n\t\t\t\tthis.closeHandler = event => {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t};\n\t\t\tthis.toggle.addEventListener(\"click\", event => {\n\t\t\t\tthis.toggleOpen();\n\t\t\t\tevent.stopPropagation();\n\t\t\t});\n\t\t\tthis.optionsInMenu.forEach(option => {\n\t\t\t\toption.addEventListener(\"click\", this.closeHandler);\n\t\t\t});\n\t\t\tif (this.options.closeOnOutsideClick) {\n\t\t\t\tdocument.addEventListener(\"click\", this.documentClickHandler);\n\t\t\t}\n\t\t\tdropdown._fbDropdown = this;\n\t\t}\n\t\tshow() {\n\t\t\tlet openToLeft = false;\n\t\t\tswitch (this.options.openingSide) {\n\t\t\tcase \"left\":\n\t\t\t\topenToLeft = true;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\topenToLeft = false;\n\t\t\t\tbreak;\n\t\t\tcase \"auto\":\n\t\t\tdefault:\n\t\t\t\tlet parentRect;\n\t\t\t\tif (this.options.openingSideToPage) {\n\t\t\t\t\tparentRect = document.body.getBoundingClientRect();\n\t\t\t\t} else {\n\t\t\t\t\tparentRect = this.dropdown.parentElement.getBoundingClientRect();\n\t\t\t\t}\n\t\t\t\tlet buttonRect = this.toggle.getBoundingClientRect();\n\t\t\t\tthis.content.style.removeProperty(\"right\");\n\t\t\t\tthis.content.style.removeProperty(\"left\");\n\t\t\t\tthis.content.style.removeProperty(\"top\");\n\t\t\t\tthis.content.style.removeProperty(\"bottom\");\n\t\t\t\tlet rect = this.content.getBoundingClientRect();\n\t\t\t\tlet openToRightDistance = parentRect.right - (buttonRect.left + rect.width);\n\t\t\t\tlet openToLeftDistance = buttonRect.right - rect.width - parentRect.left;\n\t\t\t\tif (openToLeftDistance > openToRightDistance) {\n\t\t\t\t\topenToLeft = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (openToLeft) {\n\t\t\t\tthis.content.style.right = \"0\";\n\t\t\t}\n\t\t\tthis.content.classList.add(\"show\");\n\t\t\tthis.isOpen = true;\n\t\t}\n\t\thide() {\n\t\t\tthis.content.classList.remove(\"show\");\n\t\t\tthis.isOpen = false;\n\t\t}\n\t\ttoggleOpen() {\n\t\t\tthis.isOpen = !this.isOpen;\n\t\t\tif (this.isOpen) {\n\t\t\t\tthis.show();\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\t}\n\tFBDropdown.version = \"1.0.0\";\n\tif (typeof exports === \"undefined\") {\n\t\texports = window;\n\t}\n\tclass FileBrowser {\n\t\tstatic extensionToIcon = {\n\t\t\ttxt: \"fas fa-file-alt\",\n\t\t\tpdf: \"fas fa-file-pdf\",\n\t\t\tdoc: \"fas fa-file-word\",\n\t\t\tdocx: \"fas fa-file-word\",\n\t\t\txls: \"fas fa-file-excel\",\n\t\t\txlsx: \"fas fa-file-excel\",\n\t\t\tppt: \"fas fa-file-powerpoint\",\n\t\t\tpptx: \"fas fa-file-powerpoint\",\n\t\t\tjpg: \"fas fa-file-image\",\n\t\t\tjpeg: \"fas fa-file-image\",\n\t\t\tpng: \"fas fa-file-image\",\n\t\t\tgif: \"fas fa-file-image\",\n\t\t\tmp3: \"fas fa-file-audio\",\n\t\t\twav: \"fas fa-file-audio\",\n\t\t\tmov: \"fas fa-file-video\",\n\t\t\tmp4: \"fas fa-file-video\",\n\t\t\tavi: \"fas fa-file-video\",\n\t\t\tzip: \"fas fa-file-archive\",\n\t\t\trar: \"fas fa-file-archive\",\n\t\t\ttar: \"fas fa-file-archive\",\n\t\t\tgz: \"fas fa-file-archive\",\n\t\t\t\"7z\": \"fas fa-file-archive\",\n\t\t\texe: \"fas fa-file-executable\",\n\t\t\tjs: \"fas fa-file-code\",\n\t\t\tcss: \"fas fa-file-code\",\n\t\t\thtml: \"fas fa-file-code\",\n\t\t\tphp: \"fas fa-file-code\",\n\t\t\tpy: \"fas fa-file-code\",\n\t\t\tjava: \"fas fa-file-code\",\n\t\t\tc: \"fas fa-file-code\",\n\t\t\tcpp: \"fas fa-file-code\",\n\t\t\th: \"fas fa-file-code\",\n\t\t\thpp: \"fas fa-file-code\",\n\t\t\tjson: \"fas fa-file-code\",\n\t\t\txml: \"fas fa-file-code\",\n\t\t\tcsv: \"fas fa-file-excel\",\n\t\t\tfile: \"fas fa-file\",\n\t\t\thtml: \"fas fa-file-code\",\n\t\t\tmd: \"fas fa-file-alt\"\n\t\t};\n\t\tstatic defaultOptions = {\n\t\t\tmode: \"list\",\n\t\t\torderColumn: \"filename\",\n\t\t\torderAscending: true,\n\t\t\thideZeroSize: true,\n\t\t\tallowDuplicates: false,\n\t\t\tseparateFoldersFromFiles: true,\n\t\t\tenableSelection: true,\n\t\t\tallowMultipleSelection: true,\n\t\t\tonFileClick: file => {},\n\t\t\tonFileDoubleClick: file => {},\n\t\t\tonSelectionUpdate: files => {},\n\t\t\toverlayGenerator: file => null,\n\t\t\tonHtmlCreated: (element, file, mode) => {},\n\t\t\tonFileDownload: null,\n\t\t\tonFileDelete: null,\n\t\t\tonFileRename: null,\n\t\t\tonFileCopy: null,\n\t\t\tonFileMove: null,\n\t\t\tonFileShare: null,\n\t\t\tonFileInfo: null,\n\t\t\textensionToIcon: FileBrowser.extensionToIcon,\n\t\t\tcustomContextMenu: null\n\t\t};\n\t\tstatic mutationObserver = new MutationObserver(mutations => {\n\t\t\tFileBrowser.fromDOM(document.querySelectorAll(\".fb-filebrowser\"));\n\t\t});\n\t\tstatic fromDOM(objects, options = {}) {\n\t\t\tlet result = [];\n\t\t\tif (objects instanceof Element) {\n\t\t\t\tobjects = [objects];\n\t\t\t} else if (objects instanceof NodeList) {\n\t\t\t\tobjects = Array.from(objects);\n\t\t\t} else if (!Array.isArray(objects)) {\n\t\t\t\tthrow new Error(\"Invalid type of objects\");\n\t\t\t}\n\t\t\tif (objects.length === 0) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tobjects.forEach(filebrowser => {\n\t\t\t\tlet current = filebrowser._fbFileBrowser ?? null;\n\t\t\t\tif (current === null) {\n\t\t\t\t\tcurrent = new FileBrowser(filebrowser, options);\n\t\t\t\t}\n\t\t\t\tresult.push(current);\n\t\t\t});\n\t\t\tif (objects.length === 1) {\n\t\t\t\treturn result[0];\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\t_lastFileSelected = null;\n\t\tconstructor(element, options = {}) {\n\t\t\tif (element instanceof Element) {} else if (typeof element === \"string\") {\n\t\t\t\telement = document.querySelector(element);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Invalid element\");\n\t\t\t}\n\t\t\tif (element._fbFileBrowser !== undefined) {\n\t\t\t\tif (Object.keys(options).length > 0) {\n\t\t\t\t\tconsole.warn(\"Options are being ignored as the FileBrowser already exists. Please use updateOptions instead\");\n\t\t\t\t}\n\t\t\t\treturn element._fbFileBrowser;\n\t\t\t}\n\t\t\tlet optionsFromDOM = FileBrowser._optionsFromDOM(element, FileBrowser.defaultOptions, \"fb\");\n\t\t\tthis.options = Object.assign({}, FileBrowser.defaultOptions, optionsFromDOM, options);\n\t\t\tthis.mode = null;\n\t\t\tthis.filelist = [];\n\t\t\tthis._elementsPlace = null;\n\t\t\tthis._htmlElement = element;\n\t\t\tthis._evaluateOptions();\n\t\t\telement._fbFileBrowser = this;\n\t\t\tlet files = element.querySelectorAll(\"fb-file\");\n\t\t\tlet existingFiles = Array.from(files).map(file => {\n\t\t\t\tconst basicFileInformation = {\n\t\t\t\t\tfilename: \"\",\n\t\t\t\t\tsize: 0,\n\t\t\t\t\tmodified: null,\n\t\t\t\t\tisDirectory: false,\n\t\t\t\t\ttype: \"file\",\n\t\t\t\t\tpreviewUrl: null,\n\t\t\t\t\ticon: null,\n\t\t\t\t\tdata: null\n\t\t\t\t};\n\t\t\t\tlet options = FileBrowser._optionsFromDOM(file, basicFileInformation, \"fb\");\n\t\t\t\treturn Object.assign({}, {\n\t\t\t\t\tfilename: file.textContent,\n\t\t\t\t\tsize: 0,\n\t\t\t\t\tmodified: null\n\t\t\t\t}, options);\n\t\t\t});\n\t\t\tthis.render();\n\t\t\texistingFiles.forEach(file => {\n\t\t\t\tif (file.isDirectory) {\n\t\t\t\t\tthis.addFolder(file.filename, file.modified, file);\n\t\t\t\t} else {\n\t\t\t\t\tthis.addFile(file.filename, file.size, file.modified, file);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tupdateOptions(options, fromClear = false) {\n\t\t\tlet existingOptions = Object.assign({}, this.options);\n\t\t\tif (fromClear) {\n\t\t\t\tthis.options = Object.assign({}, FileBrowser.defaultOptions, options);\n\t\t\t} else {\n\t\t\t\tthis.options = Object.assign({}, this.options, options);\n\t\t\t}\n\t\t\tthis._evaluateOptions();\n\t\t\tlet changed = false;\n\t\t\tfor (let key in this.options) {\n\t\t\t\tif (typeof this.options[key] === \"function\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (this.options[key] != existingOptions[key]) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!changed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.render();\n\t\t}\n\t\tgetFiles() {\n\t\t\treturn this.filelist;\n\t\t}\n\t\tgetSelectedFiles() {\n\t\t\treturn this.filelist.filter(file => file.selected);\n\t\t}\n\t\tclearSelection() {\n\t\t\tthis.filelist.forEach(file => file.unselect());\n\t\t}\n\t\t_setMode(mode) {\n\t\t\tswitch (mode.toLowerCase()) {\n\t\t\tcase \"list\":\n\t\t\tcase \"grid\":\n\t\t\tcase \"preview\":\n\t\t\t\tthis.mode = mode;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"Invalid mode\");\n\t\t\t}\n\t\t}\n\t\t_addFile(filename, options = {}) {\n\t\t\tif (!this.options.allowDuplicates) {\n\t\t\t\tlet existing = this.filelist.find(file => file.filename === filename);\n\t\t\t\tif (existing !== undefined) {\n\t\t\t\t\tthrow new Error(\"File already exists\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tfilename = `${filename}`;\n\t\t\toptions = Object.assign({}, {\n\t\t\t\tcontextMenu: this.options.customContextMenu,\n\t\t\t\ticon: options.isDirectory ? \"fa-regular fa-folder\" : this._filenameToIcon(filename),\n\t\t\t\ttype: filename.split(\".\").pop().toLowerCase(),\n\t\t\t\tonFileClick: (file, e) => {\n\t\t\t\t\tif (this.options.enableSelection) {\n\t\t\t\t\t\tlet indexesSelected = this.filelist.filter(file => file.selected).map(file => this.filelist.indexOf(file));\n\t\t\t\t\t\tif (!this.options.allowMultipleSelection) {\n\t\t\t\t\t\t\tthis.clearSelection();\n\t\t\t\t\t\t\tfile.select();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!e.shiftKey && !e.ctrlKey && !e.metaKey) {\n\t\t\t\t\t\t\t\tthis.clearSelection();\n\t\t\t\t\t\t\t\tfile.select();\n\t\t\t\t\t\t\t\tthis._lastFileSelected = file;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\t\t\tif (this._lastFileSelected !== null) {\n\t\t\t\t\t\t\t\t\tlet lastFileIndex = this.filelist.indexOf(this._lastFileSelected);\n\t\t\t\t\t\t\t\t\tlet currentFileIndex = this.filelist.indexOf(file);\n\t\t\t\t\t\t\t\t\tlet start = Math.min(lastFileIndex, currentFileIndex);\n\t\t\t\t\t\t\t\t\tlet end = Math.max(lastFileIndex, currentFileIndex);\n\t\t\t\t\t\t\t\t\tfor (let i = start; i <= end; i++) {\n\t\t\t\t\t\t\t\t\t\tthis.filelist[i].select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfile.select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis._lastFileSelected = file;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (e.ctrlKey || e.metaKey) {\n\t\t\t\t\t\t\t\t\tfile.toggleSelect();\n\t\t\t\t\t\t\t\t\tif (file.selected) {\n\t\t\t\t\t\t\t\t\t\tthis._lastFileSelected = file;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthis._lastFileSelected = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet indexesSelectedNow = this.filelist.filter(file => file.selected).map(file => this.filelist.indexOf(file));\n\t\t\t\t\t\tif (indexesSelected.join(\",\") !== indexesSelectedNow.join(\",\")) {\n\t\t\t\t\t\t\tthis.options.onSelectionUpdate(this.getSelectedFiles());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.options.onFileClick(file, e);\n\t\t\t\t},\n\t\t\t\tonFileDoubleClick: this.options.onFileDoubleClick\n\t\t\t}, options);\n\t\t\tlet file = new FileInFileBrowser(filename, options);\n\t\t\tlet nextFile = this._findNextFile(file);\n\t\t\tif (nextFile !== null) {\n\t\t\t\tthis.filelist.splice(this.filelist.indexOf(nextFile), 0, file);\n\t\t\t\tthis._placeFile(this._renderFile(file), nextFile);\n\t\t\t} else {\n\t\t\t\tthis.filelist.push(file);\n\t\t\t\tthis._placeFile(this._renderFile(file));\n\t\t\t}\n\t\t\treturn file;\n\t\t}\n\t\taddFile(filename, size, modified, options = {}) {\n\t\t\treturn this._addFile(filename, Object.assign({}, options, {\n\t\t\t\tisDirectory: false,\n\t\t\t\tsize: size,\n\t\t\t\tmodified: modified\n\t\t\t}));\n\t\t}\n\t\taddOrUpdateFile(filename, options = {}) {\n\t\t\tlet existing = this.findFile(filename);\n\t\t\toptions = Object.assign({}, options, {\n\t\t\t\tisDirectory: false,\n\t\t\t\ttype: filename.split(\".\").pop().toLowerCase()\n\t\t\t});\n\t\t\tif (existing === null) {\n\t\t\t\treturn this.addFile(filename, 0, new Date(), options);\n\t\t\t}\n\t\t\tif (existing.isDirectory) {\n\t\t\t\tthrow new Error(\"Existing file is not a file\");\n\t\t\t}\n\t\t\treturn this.updateFile(filename, options);\n\t\t}\n\t\tupdateFile(filename, options = {}) {\n\t\t\tlet existing = this.findFile(filename);\n\t\t\tif (existing === null) {\n\t\t\t\tthrow new Error(\"File not found\");\n\t\t\t}\n\t\t\tlet htmlElement = existing._htmlElement;\n\t\t\tif (existing.compareOptions(options)) {\n\t\t\t\treturn existing;\n\t\t\t}\n\t\t\thtmlElement.remove();\n\t\t\texisting.update(options);\n\t\t\tlet nextFile = this._findNextFile(existing);\n\t\t\tif (nextFile !== null) {\n\t\t\t\tthis.filelist.splice(this.filelist.indexOf(nextFile), 0, existing);\n\t\t\t\tthis._placeFile(this._renderFile(existing), nextFile);\n\t\t\t} else {\n\t\t\t\tthis.filelist.push(existing);\n\t\t\t\tthis._placeFile(this._renderFile(existing));\n\t\t\t}\n\t\t\treturn existing;\n\t\t}\n\t\taddFolder(name, modified, options = {}) {\n\t\t\treturn this._addFile(name, Object.assign({}, {\n\t\t\t\ticon: \"fa-regular fa-folder\",\n\t\t\t\tsize: null\n\t\t\t}, options, {\n\t\t\t\tisDirectory: true,\n\t\t\t\tmodified: modified,\n\t\t\t\ttype: \"folder\"\n\t\t\t}));\n\t\t}\n\t\tupdateFolder(name, options = {}) {\n\t\t\tlet existing = this.findFile(name);\n\t\t\tif (existing === null) {\n\t\t\t\tthrow new Error(\"Folder not found\");\n\t\t\t}\n\t\t\tif (!existing.isDirectory) {\n\t\t\t\tthrow new Error(\"Existing file is not a folder\");\n\t\t\t}\n\t\t\toptions = Object.assign({}, options, {\n\t\t\t\tisDirectory: true,\n\t\t\t\ttype: \"folder\"\n\t\t\t});\n\t\t\tlet htmlElement = existing._htmlElement;\n\t\t\tif (existing.compareOptions(options)) {\n\t\t\t\treturn existing;\n\t\t\t}\n\t\t\thtmlElement.remove();\n\t\t\texisting.update(options);\n\t\t\tlet nextFile = this._findNextFile(existing);\n\t\t\tif (nextFile !== null) {\n\t\t\t\tthis.filelist.splice(this.filelist.indexOf(nextFile), 0, existing);\n\t\t\t\tthis._placeFile(this._renderFile(existing), nextFile);\n\t\t\t} else {\n\t\t\t\tthis.filelist.push(existing);\n\t\t\t\tthis._placeFile(this._renderFile(existing));\n\t\t\t}\n\t\t\treturn existing;\n\t\t}\n\t\taddOrUpdateFolder(name, options = {}) {\n\t\t\tlet existing = this.findFile(name);\n\t\t\toptions = Object.assign({}, options, {\n\t\t\t\tisDirectory: true,\n\t\t\t\ttype: \"folder\"\n\t\t\t});\n\t\t\tif (existing === null) {\n\t\t\t\treturn this.addFolder(name, new Date(), options);\n\t\t\t}\n\t\t\tif (!existing.isDirectory) {\n\t\t\t\tthrow new Error(\"Existing file is not a folder\");\n\t\t\t}\n\t\t\treturn this.updateFolder(name, options);\n\t\t}\n\t\tfindFile(filename) {\n\t\t\tlet existing = this.filelist.find(file => file.filename === filename);\n\t\t\tif (existing === undefined) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn existing;\n\t\t}\n\t\tfindFiles(filter) {\n\t\t\tlet regex = new RegExp(filter.replace(/\\*/g, \".*\").replace(/\\?/g, \".\"), \"i\");\n\t\t\treturn this.filelist.filter(file => regex.test(file.filename));\n\t\t}\n\t\tremoveFile(file) {\n\t\t\tif (file instanceof FileInFileBrowser) {\n\t\t\t\tlet index = this.filelist.indexOf(file);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tthis.filelist.splice(index, 1);\n\t\t\t\t}\n\t\t\t} else if (typeof file === \"string\") {\n\t\t\t\tfile = this.findFile(file);\n\t\t\t\tif (file !== null) {\n\t\t\t\t\tlet index = this.filelist.indexOf(file);\n\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\tthis.filelist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.render();\n\t\t}\n\t\tforEachFile(callback) {\n\t\t\tthis.filelist.forEach(callback);\n\t\t}\n\t\trender(mode = null) {\n\t\t\tif (mode !== null) {\n\t\t\t\tthis._setMode(mode);\n\t\t\t}\n\t\t\tthis._htmlElement.innerHTML = \"\";\n\t\t\tlet element = null;\n\t\t\tswitch (this.mode) {\n\t\t\tcase \"list\":\n\t\t\t\telement = this._createList();\n\t\t\t\tbreak;\n\t\t\tcase \"grid\":\n\t\t\t\telement = this._createGrid();\n\t\t\t\tbreak;\n\t\t\tcase \"preview\":\n\t\t\t\telement = this._createPreview();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._renderFiles();\n\t\t\tthis._htmlElement.appendChild(element);\n\t\t\tif (this.mode === \"list\") {\n\t\t\t\tlet resizableColumnTable = new ResizableColumnTable(element, {\n\t\t\t\t\tsortableHeaders: true,\n\t\t\t\t\tonSort: (column, ascending) => {\n\t\t\t\t\t\tswitch (column.textContent.trim().toLowerCase()) {\n\t\t\t\t\t\tcase \"name\":\n\t\t\t\t\t\t\tthis.sort(\"filename\", ascending == \"asc\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"size\":\n\t\t\t\t\t\t\tthis.sort(\"size\", ascending == \"asc\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"modified\":\n\t\t\t\t\t\t\tthis.sort(\"modified\", ascending == \"asc\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tswitch (this.options.orderColumn) {\n\t\t\t\tcase \"filename\":\n\t\t\t\t\tresizableColumnTable.setOrder(0, this.options.orderAscending ? \"asc\" : \"desc\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"size\":\n\t\t\t\t\tresizableColumnTable.setOrder(1, this.options.orderAscending ? \"asc\" : \"desc\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"modified\":\n\t\t\t\t\tresizableColumnTable.setOrder(2, this.options.orderAscending ? \"asc\" : \"desc\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._lastFileSelected = null;\n\t\t}\n\t\tsort(column, ascending) {\n\t\t\tlet sortFunction = this._getSortFunction(column, ascending);\n\t\t\tthis.options.orderColumn = column;\n\t\t\tthis.options.orderAscending = ascending;\n\t\t\tthis.filelist.sort(sortFunction);\n\t\t\tthis._elementsPlace.innerHTML = \"\";\n\t\t\tthis._renderFiles();\n\t\t}\n\t\tclear() {\n\t\t\tthis.filelist = [];\n\t\t\tthis.render();\n\t\t}\n\t\tstatic _optionsFromDOM(element, defaultOptions = {}, prefix = \"fb\") {\n\t\t\tlet options = {};\n\t\t\tfor (let key in defaultOptions) {\n\t\t\t\tlet dataKey = prefix + key[0].toUpperCase() + key.slice(1);\n\t\t\t\tif (element.dataset[dataKey] !== undefined) {\n\t\t\t\t\tlet value = element.dataset[dataKey];\n\t\t\t\t\tif (value === \"true\" || value === \"false\") {\n\t\t\t\t\t\toptions[key] = value === \"true\";\n\t\t\t\t\t} else if (!isNaN(parseFloat(value)) && parseFloat(value).toString() == value) {\n\t\t\t\t\t\toptions[key] = parseFloat(value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions[key] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\t_generateContextMenu() {\n\t\t\tlet contextMenu = {};\n\t\t\tif (this.options.onFileDownload instanceof Function) {\n\t\t\t\tcontextMenu[\"download\"] = {\n\t\t\t\t\tlabel: \"Download\",\n\t\t\t\t\thandler: this.options.onFileDownload\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileDelete instanceof Function) {\n\t\t\t\tcontextMenu[\"delete\"] = {\n\t\t\t\t\tlabel: \"Delete\",\n\t\t\t\t\thandler: this.options.onFileDelete\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileRename instanceof Function) {\n\t\t\t\tcontextMenu[\"rename\"] = {\n\t\t\t\t\tlabel: \"Rename\",\n\t\t\t\t\thandler: this.options.onFileRename\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileCopy instanceof Function) {\n\t\t\t\tcontextMenu[\"copy\"] = {\n\t\t\t\t\tlabel: \"Copy\",\n\t\t\t\t\thandler: this.options.onFileCopy\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileMove instanceof Function) {\n\t\t\t\tcontextMenu[\"move\"] = {\n\t\t\t\t\tlabel: \"Move\",\n\t\t\t\t\thandler: this.options.onFileMove\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileShare instanceof Function) {\n\t\t\t\tcontextMenu[\"share\"] = {\n\t\t\t\t\tlabel: \"Share\",\n\t\t\t\t\thandler: this.options.onFileShare\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileInfo instanceof Function) {\n\t\t\t\tcontextMenu[\"info\"] = {\n\t\t\t\t\tlabel: \"Info\",\n\t\t\t\t\thandler: this.options.onFileInfo\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (Object.keys(contextMenu).length > 0) {\n\t\t\t\tcontextMenu.__generated = true;\n\t\t\t\treturn contextMenu;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t_evaluateOptions() {\n\t\t\tthis._setMode(this.options.mode);\n\t\t\tthis.options.onHtmlCreated = this.options.onHtmlCreated?.bind(this);\n\t\t\tlet callbacks = [\"onFileClick\", \"onFileDoubleClick\", \"onSelectionUpdate\", \"onFileDownload\", \"onFileDelete\", \"onFileRename\", \"onFileCopy\", \"onFileMove\", \"onFileShare\", \"onFileInfo\"];\n\t\t\tcallbacks.forEach(callback => {\n\t\t\t\tthis.options[callback] = covertCallback(this.options[callback], this);\n\t\t\t});\n\t\t\tif (this.options.customContextMenu === null || this.options.customContextMenu.__generated) {\n\t\t\t\tthis.options.customContextMenu = this._generateContextMenu();\n\t\t\t}\n\t\t\tif ((this.options.extensionToIcon ?? null) === null) {\n\t\t\t\tthis.options.extensionToIcon = {};\n\t\t\t}\n\t\t\tif (typeof this.options.extensionToIcon !== \"object\") {\n\t\t\t\tthrow new Error(\"Invalid extensionToIcon\");\n\t\t\t}\n\t\t}\n\t\t_placeFile(file, nextFile = null) {\n\t\t\tif (nextFile !== null) {\n\t\t\t\tnextFile._htmlElement.insertAdjacentElement(\"beforebegin\", file._htmlElement);\n\t\t\t} else {\n\t\t\t\tthis._elementsPlace.appendChild(file._htmlElement);\n\t\t\t}\n\t\t\treturn file;\n\t\t}\n\t\t_renderFile(file) {\n\t\t\tlet element = null;\n\t\t\tswitch (this.mode) {\n\t\t\tcase \"list\":\n\t\t\t\telement = file.tableRow();\n\t\t\t\tbreak;\n\t\t\tcase \"grid\":\n\t\t\t\telement = file.gridElement(this.options.overlayGenerator);\n\t\t\t\tbreak;\n\t\t\tcase \"preview\":\n\t\t\t\telement = file.previewElement(this.options.overlayGenerator);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (this.options.hideZeroSize && file.size === 0) {\n\t\t\t\telement.querySelector(\".fb-file-size\").innerHTML = \"\";\n\t\t\t}\n\t\t\tthis.options.onHtmlCreated?.call(this, element, file, this.mode);\n\t\t\treturn file;\n\t\t}\n\t\t_getDirectoryAndShowFirstComparisonFunctions() {\n\t\t\tif (this.options.separateFoldersFromFiles) {\n\t\t\t\treturn function (a, b) {\n\t\t\t\t\tif (a.isDirectory && !b.isDirectory) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (!a.isDirectory && b.isDirectory) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (a.showFirst && !b.showFirst) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (!a.showFirst && b.showFirst) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn function (a, b) {\n\t\t\t\t\tif (a.showFirst && !b.showFirst) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (!a.showFirst && b.showFirst) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t_getSortFunction(column = null, ascending = null) {\n\t\t\tif (column === null) {\n\t\t\t\tcolumn = this.options.orderColumn;\n\t\t\t}\n\t\t\tif (ascending === null) {\n\t\t\t\tascending = this.options.orderAscending;\n\t\t\t}\n\t\t\tlet sortFunction = null;\n\t\t\tlet checkDirectoryAndShowFirst = this._getDirectoryAndShowFirstComparisonFunctions();\n\t\t\tswitch (column) {\n\t\t\tcase \"filename\":\n\t\t\t\tsortFunction = (a, b) => a.filename.localeCompare(b.filename);\n\t\t\t\tbreak;\n\t\t\tcase \"size\":\n\t\t\t\tsortFunction = (a, b) => a.size - b.size;\n\t\t\t\tbreak;\n\t\t\tcase \"modified\":\n\t\t\t\tsortFunction = (a, b) => {\n\t\t\t\t\tif (a.modified === null) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (b.modified === null) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.modified.getTime() - b.modified.getTime();\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase \"type\":\n\t\t\t\tsortFunction = (a, b) => a.type.localeCompare(b.type);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"Invalid column\");\n\t\t\t}\n\t\t\tlet multiplyer = ascending ? 1 : -1;\n\t\t\treturn (a, b) => {\n\t\t\t\tlet result = checkDirectoryAndShowFirst(a, b);\n\t\t\t\tif (result !== 0) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\treturn multiplyer * sortFunction(a, b);\n\t\t\t};\n\t\t}\n\t\t_findNextFile(file) {\n\t\t\tlet sortFunction = this._getSortFunction();\n\t\t\tif (this.filelist.length == 0) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tfor (let i = 0; i < this.filelist.length; i++) {\n\t\t\t\tif (sortFunction(file, this.filelist[i]) < 0) {\n\t\t\t\t\treturn this.filelist[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t_filenameToIcon(filename) {\n\t\t\tlet extension = filename.split(\".\").pop().toLowerCase();\n\t\t\tif (this.options.extensionToIcon instanceof Function) {\n\t\t\t\treturn this.options.extensionToIcon(extension);\n\t\t\t}\n\t\t\tif (extension in this.options.extensionToIcon) {\n\t\t\t\treturn this.options.extensionToIcon[extension];\n\t\t\t}\n\t\t\treturn this.options.extensionToIcon[\"\"] || \"far fa-file\";\n\t\t}\n\t\t_createGrid() {\n\t\t\tlet grid = document.createElement(\"div\");\n\t\t\tgrid.classList.add(\"fb-grid\");\n\t\t\tthis._elementsPlace = grid;\n\t\t\treturn grid;\n\t\t}\n\t\t_createPreview() {\n\t\t\tlet preview = document.createElement(\"div\");\n\t\t\tpreview.classList.add(\"fb-preview\");\n\t\t\tthis._elementsPlace = preview;\n\t\t\treturn preview;\n\t\t}\n\t\t_createList() {\n\t\t\tlet list = document.createElement(\"div\");\n\t\t\tlist.classList.add(\"fb-list\");\n\t\t\tlist.innerHTML = `\n        <table>\n            <thead>\n                <tr>\n                    <th class=\"fb-file-name\">Name</th>\n                    <th class=\"fb-file-size\">Size</th>\n                    <th class=\"fb-file-modified\">Modified</th>\n                </tr>\n            </thead>\n            <tbody></tbody>\n        </table>\n        `;\n\t\t\tthis._elementsPlace = list.querySelector(\"tbody\");\n\t\t\treturn list;\n\t\t}\n\t\t_renderFiles() {\n\t\t\tthis.filelist.forEach(file => {\n\t\t\t\tthis._placeFile(this._renderFile(file));\n\t\t\t});\n\t\t}\n\t}\n\tFileBrowser.version = \"1.0.5\";\n\tdocument.addEventListener(\"DOMContentLoaded\", () => {\n\t\tFileBrowser.mutationObserver.observe(document.body, {\n\t\t\tchildList: true,\n\t\t\tsubtree: true\n\t\t});\n\t\tFileBrowser.fromDOM(document.querySelectorAll(\".fb-filebrowser\"));\n\t});\n\texports.FileBrowser = FileBrowser;\n\tif (typeof exports === \"undefined\") {\n\t\texports = window;\n\t}\n\tclass FileInFileBrowser {\n\t\tstatic defaultOptions = {\n\t\t\tsize: 0,\n\t\t\tmodified: null,\n\t\t\ticon: \"fa fa-file\",\n\t\t\ttype: \"file\",\n\t\t\tisDirectory: false,\n\t\t\tshowFirst: false,\n\t\t\tpreviewUrl: null,\n\t\t\tonFileClick: null,\n\t\t\tonFileDoubleClick: null,\n\t\t\tdata: null,\n\t\t\tcontextMenu: null\n\t\t};\n\t\tconstructor(filename, options = {}) {\n\t\t\toptions = Object.assign({}, FileInFileBrowser.defaultOptions, options);\n\t\t\tthis.update(options);\n\t\t\tthis.filename = filename;\n\t\t\tthis.selected = false;\n\t\t\tthis._htmlElement = null;\n\t\t}\n\t\t_modifiedToDate(modified) {\n\t\t\tif (modified === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (typeof modified === \"string\" || modified instanceof String) {\n\t\t\t\tif (!isNaN(modified)) {\n\t\t\t\t\tmodified = parseInt(modified);\n\t\t\t\t} else {\n\t\t\t\t\tlet date = new Date(modified);\n\t\t\t\t\tif (date.toString() !== \"Invalid Date\") {\n\t\t\t\t\t\tmodified = date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof modified === \"number\" || modified instanceof Number) {\n\t\t\t\tlet date = new Date(modified);\n\t\t\t\tif (date.toString() !== \"Invalid Date\") {\n\t\t\t\t\tmodified = date;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (modified instanceof Date) {\n\t\t\t\treturn modified;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t_setModified(modified) {\n\t\t\tthis.modified = this._modifiedToDate(modified);\n\t\t}\n\t\tcompareOptions(options) {\n\t\t\tfor (let option in FileInFileBrowser.defaultOptions) {\n\t\t\t\tif (options[option] !== undefined) {\n\t\t\t\t\tswitch (option) {\n\t\t\t\t\tcase \"modified\":\n\t\t\t\t\t\tif (this.modified?.getTime() !== this._modifiedToDate(options[option])?.getTime()) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (this[option] !== options[option]) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tupdate(options = {}) {\n\t\t\tlet optionNames = Object.keys(FileInFileBrowser.defaultOptions);\n\t\t\tfor (let option of optionNames) {\n\t\t\t\tif (options[option] !== undefined) {\n\t\t\t\t\tswitch (option) {\n\t\t\t\t\tcase \"modified\":\n\t\t\t\t\t\tthis._setModified(options[option]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis[option] = options[option];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.isDirectory = options.isDirectory ?? false;\n\t\t}\n\t\tselect() {\n\t\t\tthis.selected = true;\n\t\t\tif (this._htmlElement) {\n\t\t\t\tthis._htmlElement.classList.add(\"selected\");\n\t\t\t}\n\t\t}\n\t\tunselect() {\n\t\t\tthis.selected = false;\n\t\t\tif (this._htmlElement) {\n\t\t\t\tthis._htmlElement.classList.remove(\"selected\");\n\t\t\t}\n\t\t}\n\t\ttoggleSelect() {\n\t\t\tif (this.selected) {\n\t\t\t\tthis.unselect();\n\t\t\t} else {\n\t\t\t\tthis.select();\n\t\t\t}\n\t\t}\n\t\tinsertBefore(otherFile) {\n\t\t\tif (this._htmlElement !== null && otherFile._htmlElement !== null) {\n\t\t\t\totherFile._htmlElement.insertAdjacentElement(\"beforebegin\", this._htmlElement);\n\t\t\t}\n\t\t}\n\t\tinsertAfter(otherFile) {\n\t\t\tif (this._htmlElement !== null && otherFile._htmlElement !== null) {\n\t\t\t\totherFile._htmlElement.insertAdjacentElement(\"afterend\", this._htmlElement);\n\t\t\t}\n\t\t}\n\t\tcreateContextMenu() {\n\t\t\tif (this.contextMenu === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tlet contextMenu = document.createElement(\"div\");\n\t\t\tcontextMenu.classList.add(\"fb-dropdown\", \"fb-dropdown-s\", \"fb-file-context-menu\");\n\t\t\tcontextMenu.innerHTML = `\n            <button class=\"fb-dropdown-toggle\" type=\"button\">\n                <i class=\"fa fa-ellipsis-v\"></i>\n            </button>`;\n\t\t\tlet dropdownContent = document.createElement(\"ul\");\n\t\t\tdropdownContent.classList.add(\"fb-dropdown-content\");\n\t\t\tlet contextMenuOptions = this.contextMenu;\n\t\t\tif (contextMenuOptions instanceof Array) {\n\t\t\t\tcontextMenuOptions = contextMenuOptions.reduce((acc, item) => {\n\t\t\t\t\tacc[item] = {};\n\t\t\t\t\treturn acc;\n\t\t\t\t}, {});\n\t\t\t}\n\t\t\tfor (let option in contextMenuOptions) {\n\t\t\t\tif (option.startsWith(\"__\")) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet item = document.createElement(\"li\");\n\t\t\t\tlet button = document.createElement(\"button\");\n\t\t\t\tbutton.type = \"button\";\n\t\t\t\tbutton.dataset.action = option;\n\t\t\t\tlet text = contextMenuOptions[option].label ?? option;\n\t\t\t\tif (contextMenuOptions[option].icon) {\n\t\t\t\t\tbutton.innerHTML = `<i class=\"${contextMenuOptions[option].icon}\"></i> ${text}`;\n\t\t\t\t} else {\n\t\t\t\t\tbutton.innerText = text;\n\t\t\t\t}\n\t\t\t\tlet handler = contextMenuOptions[option].handler ?? contextMenuOptions[option];\n\t\t\t\tif (handler instanceof Function) {\n\t\t\t\t\tbutton.addEventListener(\"click\", file => {\n\t\t\t\t\t\thandler(this);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\titem.appendChild(button);\n\t\t\t\tdropdownContent.appendChild(item);\n\t\t\t}\n\t\t\tcontextMenu.appendChild(dropdownContent);\n\t\t\tnew FBDropdown(contextMenu, {\n\t\t\t\tcloseOnOutsideClick: true\n\t\t\t});\n\t\t\treturn contextMenu;\n\t\t}\n\t\ttableRow() {\n\t\t\tif (this._htmlElement !== null) {\n\t\t\t\tthis._htmlElement.remove();\n\t\t\t}\n\t\t\tlet row = document.createElement(\"tr\");\n\t\t\trow.innerHTML = `\n            <td class=\"fb-file-name\"><span class=\"fb-file-icon\"><i class=\"${this.icon}\"></i></span> ${this.filename}</td>\n            <td class=\"fb-file-size\">${toHumanSize(this.size)}</td>\n            <td class=\"fb-file-modified\">${this._modifiedStr()}</td>\n        `;\n\t\t\trow.dataset.filename = btoa_utf8(this.filename);\n\t\t\trow.dataset.size = this.size;\n\t\t\trow.dataset.modified = this.modified?.getTime();\n\t\t\trow.dataset.type = this.type;\n\t\t\tif (this.selected) {\n\t\t\t\trow.classList.add(\"selected\");\n\t\t\t}\n\t\t\trow.addEventListener(\"click\", e => {\n\t\t\t\tif (this.onFileClick instanceof Function) {\n\t\t\t\t\tthis.onFileClick(this, e);\n\t\t\t\t}\n\t\t\t});\n\t\t\trow.addEventListener(\"dblclick\", e => {\n\t\t\t\tif (this.onFileDoubleClick instanceof Function) {\n\t\t\t\t\tthis.onFileDoubleClick(this, e);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (this.selected) {\n\t\t\t\trow.classList.add(\"selected\");\n\t\t\t}\n\t\t\tthis._htmlElement = row;\n\t\t\treturn this._htmlElement;\n\t\t}\n\t\tpreviewElement(overlayGenerator = null) {\n\t\t\tif (this._htmlElement !== null) {\n\t\t\t\tthis._htmlElement.remove();\n\t\t\t}\n\t\t\tlet overlay = null;\n\t\t\tif (overlayGenerator instanceof Function) {\n\t\t\t\toverlay = overlayGenerator(this);\n\t\t\t}\n\t\t\tlet contextMenu = this.createContextMenu();\n\t\t\tlet element = document.createElement(\"div\");\n\t\t\telement.classList.add(\"fb-file-wrapper\");\n\t\t\telement.innerHTML = `\n            <div class=\"fb-file\">\n            </div>\n        `;\n\t\t\tlet previewElement = element.querySelector(\".fb-file\");\n\t\t\tif (this.previewUrl !== null) {\n\t\t\t\tpreviewElement.innerHTML = `\n                <div class=\"fb-preview-image\">\n                    <div class=\"fb-preview-image-background\" style=\"background-image: url('${this.previewUrl}')\"></div>\n                    <div class=\"fb-preview-image-image\" style=\"background-image: url('${this.previewUrl}')\"></div>\n                </div>\n            `;\n\t\t\t} else {\n\t\t\t\tpreviewElement.innerHTML = `\n                <div class=\"fb-file-icon\">\n                    <i class=\"${this.icon}\"></i>\n                </div>`;\n\t\t\t}\n\t\t\tpreviewElement.innerHTML += `\n                <div class=\"fb-file-details\">\n                    <p class=\"fb-file-name\">${this.filename}</p>\n                    <p class=\"fb-file-size\">${toHumanSize(this.size)}</p>\n                    <p class=\"fb-file-modified\">${this._modifiedStr()}</p>\n                </div>\n        `;\n\t\t\tif (overlay !== null || contextMenu !== null) {\n\t\t\t\tlet overlayElement = document.createElement(\"div\");\n\t\t\t\toverlayElement.classList.add(\"fb-preview-overlay\");\n\t\t\t\tif (overlay !== null) {\n\t\t\t\t\toverlayElement.appendChild(overlay);\n\t\t\t\t}\n\t\t\t\tif (contextMenu !== null) {\n\t\t\t\t\toverlayElement.appendChild(contextMenu);\n\t\t\t\t}\n\t\t\t\telement.appendChild(overlayElement);\n\t\t\t}\n\t\t\telement.dataset.filename = btoa_utf8(this.filename);\n\t\t\telement.dataset.size = this.size;\n\t\t\telement.dataset.modified = this.modified?.getTime();\n\t\t\telement.dataset.type = this.type;\n\t\t\tif (this.selected) {\n\t\t\t\telement.classList.add(\"selected\");\n\t\t\t}\n\t\t\tthis._htmlElement = element;\n\t\t\telement.addEventListener(\"click\", e => {\n\t\t\t\tif (this.onFileClick instanceof Function) {\n\t\t\t\t\tthis.onFileClick(this, e);\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.addEventListener(\"dblclick\", e => {\n\t\t\t\tif (this.onFileDoubleClick instanceof Function) {\n\t\t\t\t\tthis.onFileDoubleClick(this, e);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn this._htmlElement;\n\t\t}\n\t\t_modifiedStr() {\n\t\t\treturn this.modified === null || this.modified === undefined ? \"\" : this.modified.toLocaleString();\n\t\t}\n\t\tgridElement(overlayGenerator = null) {\n\t\t\tif (this._htmlElement !== null) {\n\t\t\t\tthis._htmlElement.remove();\n\t\t\t}\n\t\t\tlet overlay = null;\n\t\t\tif (overlayGenerator instanceof Function) {\n\t\t\t\toverlay = overlayGenerator(this);\n\t\t\t}\n\t\t\tlet contextMenu = this.createContextMenu();\n\t\t\tlet element = document.createElement(\"div\");\n\t\t\telement.classList.add(\"fb-file-wrapper\");\n\t\t\telement.innerHTML = `\n            <div class=\"fb-file\">\n                <div class=\"fb-file-icon\">\n                    <i class=\"${this.icon}\"></i>\n                </div>\n                <div class=\"fb-file-details\" title=\"${this.filename}\">\n                    <p class=\"fb-file-name\">${this.filename}</p>\n                    <p class=\"fb-file-size\">${toHumanSize(this.size)}</p>\n                    <p class=\"fb-file-modified\">${this._modifiedStr()}</p>\n                </div>\n            </div>\n        `;\n\t\t\tif (overlay !== null || contextMenu !== null) {\n\t\t\t\tlet overlayElement = document.createElement(\"div\");\n\t\t\t\toverlayElement.classList.add(\"fb-file-overlay\");\n\t\t\t\tif (overlay !== null) {\n\t\t\t\t\toverlayElement.appendChild(overlay);\n\t\t\t\t}\n\t\t\t\tif (contextMenu !== null) {\n\t\t\t\t\toverlayElement.appendChild(contextMenu);\n\t\t\t\t}\n\t\t\t\telement.appendChild(overlayElement);\n\t\t\t}\n\t\t\telement.dataset.filename = btoa_utf8(this.filename);\n\t\t\telement.dataset.size = this.size;\n\t\t\telement.dataset.modified = this.modified?.getTime();\n\t\t\telement.dataset.type = this.type;\n\t\t\tif (this.selected) {\n\t\t\t\telement.classList.add(\"selected\");\n\t\t\t}\n\t\t\tthis._htmlElement = element;\n\t\t\telement.addEventListener(\"click\", e => {\n\t\t\t\tif (this.onFileClick instanceof Function) {\n\t\t\t\t\tthis.onFileClick(this, e);\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.addEventListener(\"dblclick\", e => {\n\t\t\t\tif (this.onFileDoubleClick instanceof Function) {\n\t\t\t\t\tthis.onFileDoubleClick(this, e);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn this._htmlElement;\n\t\t}\n\t}\n\texports.FileInFileBrowser = FileInFileBrowser;\n\tconst ClassesMixin = {\n\t\thasClasses: function (classes) {\n\t\t\tif (typeof classes === \"string\") {\n\t\t\t\tclasses = classes.split(\" \").map(c => c.trim()).filter(c => c.length > 0);\n\t\t\t}\n\t\t\tif (!Array.isArray(classes)) {\n\t\t\t\tthrow new Error(\"Classes must be an array or a string\");\n\t\t\t}\n\t\t\treturn classes.every(c => this.classList.contains(c));\n\t\t},\n\t\taddClasses: function (classes) {\n\t\t\tif (typeof classes === \"string\") {\n\t\t\t\tclasses = classes.split(\" \").map(c => c.trim()).filter(c => c.length > 0);\n\t\t\t}\n\t\t\tif (!Array.isArray(classes)) {\n\t\t\t\tthrow new Error(\"Classes must be an array or a string\");\n\t\t\t}\n\t\t\tclasses.forEach(c => this.classList.add(c));\n\t\t},\n\t\tremoveClasses: function (classes) {\n\t\t\tif (typeof classes === \"string\") {\n\t\t\t\tclasses = classes.split(\" \").map(c => c.trim()).filter(c => c.length > 0);\n\t\t\t}\n\t\t\tif (!Array.isArray(classes)) {\n\t\t\t\tthrow new Error(\"Classes must be an array or a string\");\n\t\t\t}\n\t\t\tclasses.forEach(c => this.classList.remove(c));\n\t\t}\n\t};\n\tclass ResizableColumnTable {\n\t\tstatic defaultOptions = {\n\t\t\tfirstColumn: 0,\n\t\t\tlastColumn: -1,\n\t\t\tsortableHeaders: true,\n\t\t\tclassSorter: \"sorter fas\",\n\t\t\tclassUnsorted: \"fa-sort\",\n\t\t\tclassSorterUp: \"up fa-sort-up\",\n\t\t\tclassSorterDown: \"down fa-sort-down\",\n\t\t\tonSort: (header, direction) => {}\n\t\t};\n\t\tconstructor(table, options = {}) {\n\t\t\tthis.options = Object.assign({}, ResizableColumnTable.defaultOptions, options);\n\t\t\tlet headers = table.querySelectorAll(\"th\");\n\t\t\tif (this.options.lastColumn < 0) {\n\t\t\t\tthis.options.lastColumn = headers.length + this.options.lastColumn;\n\t\t\t}\n\t\t\tif (this.options.lastColumn < 0 || this.options.lastColumn >= headers.length) {\n\t\t\t\tthrow new Error(\"Last column is invalid\");\n\t\t\t}\n\t\t\tif (this.options.firstColumn > this.options.lastColumn) {\n\t\t\t\tthrow new Error(\"First column is greater than last column\");\n\t\t\t}\n\t\t\tthis.table = table;\n\t\t\tthis.table._fbResizableTable = this;\n\t\t\tthis.headers = headers;\n\t\t\tthis.resizers = [];\n\t\t\tlet previousHeader = null;\n\t\t\tfor (let i = this.options.firstColumn; i < this.options.lastColumn + 1; i++) {\n\t\t\t\tlet header = headers[i];\n\t\t\t\tlet resizer = document.createElement(\"div\");\n\t\t\t\tresizer.classList.add(\"fb-resizer\");\n\t\t\t\theader.appendChild(resizer);\n\t\t\t\tthis.resizers.push(resizer);\n\t\t\t\tthis.addEventHandlers(header, resizer);\n\t\t\t\tif (previousHeader != null) {\n\t\t\t\t\tpreviousHeader._nextHeader = header;\n\t\t\t\t}\n\t\t\t\tpreviousHeader = header;\n\t\t\t}\n\t\t\tif (previousHeader != null && previousHeader != headers[headers.length - 1]) {\n\t\t\t\tpreviousHeader._nextHeader = headers[headers.length - 1];\n\t\t\t}\n\t\t\tif (this.options.sortableHeaders) {\n\t\t\t\tthis.addSortingIcons();\n\t\t\t}\n\t\t}\n\t\tsetOrder(column, direction) {\n\t\t\tif (typeof column !== \"number\") {\n\t\t\t\tthrow new Error(\"Column index must be a number\");\n\t\t\t}\n\t\t\tif (column < this.options.firstColumn || column > this.options.lastColumn) {\n\t\t\t\tthrow new Error(\"Column index out of range\");\n\t\t\t}\n\t\t\tlet header = this.headers[column];\n\t\t\tlet icon = header.querySelector(\".sorter\");\n\t\t\tif (icon == null) {\n\t\t\t\tthrow new Error(\"Column is not sortable\");\n\t\t\t}\n\t\t\ticon.removeClasses(this.options.classSorterUp);\n\t\t\ticon.removeClasses(this.options.classSorterDown);\n\t\t\ticon.addClasses(this.options.classUnsorted);\n\t\t\tif (direction == \"asc\") {\n\t\t\t\ticon.removeClasses(this.options.classUnsorted);\n\t\t\t\ticon.addClasses(this.options.classSorterUp);\n\t\t\t\ticon.removeClasses(this.options.classSorterDown);\n\t\t\t} else if (direction == \"desc\") {\n\t\t\t\ticon.removeClasses(this.options.classUnsorted);\n\t\t\t\ticon.removeClasses(this.options.classSorterUp);\n\t\t\t\ticon.addClasses(this.options.classSorterDown);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Invalid direction\");\n\t\t\t}\n\t\t}\n\t\taddSortingIcons() {\n\t\t\tlet columnIndexes = [];\n\t\t\tif (!Array.isArray(this.options.sortableHeaders)) {\n\t\t\t\tif (this.options.sortableHeaders === true) {\n\t\t\t\t\tcolumnIndexes = Array.from(this.headers).map((header, index) => index);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcolumnIndexes = this.options.sortableHeaders.filter(index => index >= 0 && index < this.headers.length);\n\t\t\t}\n\t\t\tcolumnIndexes.forEach(index => {\n\t\t\t\tlet header = this.headers[index];\n\t\t\t\tlet sortingIcon = document.createElement(\"i\");\n\t\t\t\tObject.assign(sortingIcon, ClassesMixin);\n\t\t\t\tsortingIcon.addClasses(this.options.classSorter);\n\t\t\t\tsortingIcon.addClasses(this.options.classUnsorted);\n\t\t\t\theader.addEventListener(\"click\", event => {\n\t\t\t\t\theader.closest(\"thead\").querySelectorAll(\".sorter\").forEach(icon => {\n\t\t\t\t\t\tif (icon != sortingIcon) {\n\t\t\t\t\t\t\ticon.removeClasses(this.options.classSorterUp);\n\t\t\t\t\t\t\ticon.removeClasses(this.options.classSorterDown);\n\t\t\t\t\t\t\ticon.addClasses(this.options.classUnsorted);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (sortingIcon.hasClasses(this.options.classSorterUp)) {\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classUnsorted);\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classSorterUp);\n\t\t\t\t\t\tsortingIcon.addClasses(this.options.classSorterDown);\n\t\t\t\t\t} else if (sortingIcon.hasClasses(this.options.classSorterDown)) {\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classUnsorted);\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classSorterDown);\n\t\t\t\t\t\tsortingIcon.addClasses(this.options.classSorterUp);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classUnsorted);\n\t\t\t\t\t\tsortingIcon.addClasses(this.options.classSorterUp);\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classSorterDown);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.options.onSort instanceof Function) {\n\t\t\t\t\t\tthis.options.onSort(header, sortingIcon.hasClasses(this.options.classSorterUp) ? \"asc\" : \"desc\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\theader.appendChild(sortingIcon);\n\t\t\t});\n\t\t}\n\t\tupdateResizerHeight() {\n\t\t\tthis.resizers.forEach(resizer => {\n\t\t\t\tresizer.style.height = this.table.offsetHeight + \"px\";\n\t\t\t});\n\t\t}\n\t\taddEventHandlers(th, resizer) {\n\t\t\tlet x = 0;\n\t\t\tlet width = 0;\n\t\t\tlet next_header = null;\n\t\t\tlet next_width = 0;\n\t\t\tlet mousemoveEventHander = event => {\n\t\t\t\tlet dx = event.clientX - x;\n\t\t\t\tif (width + dx < 20) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (next_header != null) {\n\t\t\t\t\tnext_header.style.width = next_width - dx + \"px\";\n\t\t\t\t\tif (next_width - dx < 20) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tth.style.width = width + dx + \"px\";\n\t\t\t};\n\t\t\tlet mouseupEventHandler = () => {\n\t\t\t\tdocument.removeEventListener(\"mousemove\", mousemoveEventHander);\n\t\t\t\tdocument.removeEventListener(\"mouseup\", mouseupEventHandler);\n\t\t\t\tth.classList.remove(\"resizing\");\n\t\t\t\tth._nextHeader?.classList.remove(\"resizing\");\n\t\t\t\tresizer.classList.remove(\"resizing\");\n\t\t\t};\n\t\t\tresizer.addEventListener(\"mousedown\", event => {\n\t\t\t\tx = event.clientX;\n\t\t\t\twidth = parseInt(window.getComputedStyle(th).width, 10);\n\t\t\t\tnext_header = th._nextHeader ?? null;\n\t\t\t\tif (next_header != null) {\n\t\t\t\t\tnext_width = parseInt(window.getComputedStyle(next_header).width, 10);\n\t\t\t\t}\n\t\t\t\tdocument.addEventListener(\"mousemove\", mousemoveEventHander);\n\t\t\t\tdocument.addEventListener(\"mouseup\", mouseupEventHandler);\n\t\t\t\tth.classList.add(\"resizing\");\n\t\t\t\tth._nextHeader?.classList.add(\"resizing\");\n\t\t\t\tresizer.classList.add(\"resizing\");\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction btoa_utf8(value) {\n\t\treturn btoa(String.fromCharCode(...new TextEncoder(\"utf-8\").encode(value)));\n\t}\n\n\tfunction atob_utf8(value) {\n\t\tconst value_latin1 = atob(value);\n\t\treturn new TextDecoder(\"utf-8\").decode(Uint8Array.from({\n\t\t\tlength: value_latin1.length\n\t\t}, (element, index) => value_latin1.charCodeAt(index)));\n\t}\n\n\tfunction toHumanSize(size) {\n\t\tif (size === null || size === undefined) {\n\t\t\treturn \"\";\n\t\t}\n\t\tconst units = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\tlet unitIndex = 0;\n\t\tsize = parseFloat(size);\n\t\tif (isNaN(size)) {\n\t\t\treturn \"0 B\";\n\t\t}\n\t\twhile (size >= 1024 && unitIndex < units.length - 1) {\n\t\t\tsize /= 1024;\n\t\t\tunitIndex++;\n\t\t}\n\t\treturn `${size.toFixed(2)} ${units[unitIndex]}`;\n\t}\n\n\tfunction covertCallback(callback, context = null) {\n\t\tif (callback === null) {\n\t\t\treturn null;\n\t\t}\n\t\tif (typeof callback === \"string\") {\n\t\t\tlet stringCallback = callback;\n\t\t\tcallback = _ => {\n\t\t\t\tconst file = _;\n\t\t\t\teval(stringCallback);\n\t\t\t};\n\t\t}\n\t\tif (callback instanceof Function) {\n\t\t\tif (context !== null) {\n\t\t\t\treturn callback.bind(context);\n\t\t\t}\n\t\t\treturn callback;\n\t\t}\n\t\tthrow new Error(\"Invalid callback\");\n\t}\n\n\tfunction isValidURL(url) {\n\t\tif (url instanceof URL) {\n\t\t\treturn true;\n\t\t}\n\t\ttry {\n\t\t\tnew URL(url);\n\t\t\treturn true;\n\t\t} catch (_) {\n\t\t\treturn false;\n\t\t}\n\t}\n})(window);\n"],"names":["exports","window","FBDropdown","defaults","closeOnOutsideClick","openingSide","openingSideToPage","extractOptions","let","options","key","this","dropdown","dataset","undefined","constructor","_fbDropdown","effectiveOptions","Object","assign","toggle","querySelector","content","isOpen","documentClickHandler","event","contains","target","hide","optionsInMenu","querySelectorAll","closeHandler","stopPropagation","addEventListener","toggleOpen","forEach","option","document","show","openToLeft","parentRect","body","getBoundingClientRect","parentElement","buttonRect","style","removeProperty","rect","openToRightDistance","right","left","width","openToLeftDistance","classList","add","remove","version","FileBrowser","extensionToIcon","txt","pdf","doc","docx","xls","xlsx","ppt","pptx","jpg","jpeg","png","gif","mp3","wav","mov","mp4","avi","zip","rar","tar","gz","7z","exe","js","css","html","php","py","java","c","cpp","h","hpp","json","xml","csv","file","md","defaultOptions","mode","orderColumn","orderAscending","hideZeroSize","allowDuplicates","separateFoldersFromFiles","enableSelection","allowMultipleSelection","onFileClick","onFileDoubleClick","onSelectionUpdate","files","overlayGenerator","onHtmlCreated","element","onFileDownload","onFileDelete","onFileRename","onFileCopy","onFileMove","onFileShare","onFileInfo","customContextMenu","mutationObserver","MutationObserver","mutations","fromDOM","objects","result","Element","NodeList","Array","from","isArray","Error","length","filebrowser","current","_fbFileBrowser","push","_lastFileSelected","keys","console","warn","optionsFromDOM","_optionsFromDOM","filelist","_elementsPlace","_htmlElement","_evaluateOptions","existingFiles","map","basicFileInformation","filename","size","modified","isDirectory","type","previewUrl","icon","data","textContent","render","addFolder","addFile","updateOptions","fromClear","existingOptions","changed","getFiles","getSelectedFiles","filter","selected","clearSelection","unselect","_setMode","toLowerCase","_addFile","existing","find","contextMenu","_filenameToIcon","split","pop","e","indexesSelected","indexOf","select","shiftKey","ctrlKey","metaKey","lastFileIndex","currentFileIndex","start","Math","min","end","max","i","toggleSelect","indexesSelectedNow","join","FileInFileBrowser","nextFile","_findNextFile","splice","_placeFile","_renderFile","addOrUpdateFile","findFile","Date","updateFile","htmlElement","compareOptions","update","name","updateFolder","addOrUpdateFolder","findFiles","regex","RegExp","replace","test","removeFile","index","forEachFile","callback","innerHTML","_createList","_createGrid","_createPreview","_renderFiles","appendChild","resizableColumnTable","ResizableColumnTable","sortableHeaders","onSort","column","ascending","trim","sort","setOrder","sortFunction","_getSortFunction","clear","prefix","dataKey","toUpperCase","slice","value","isNaN","parseFloat","toString","_generateContextMenu","Function","label","handler","__generated","bind","callbacks","covertCallback","insertAdjacentElement","tableRow","gridElement","previewElement","call","_getDirectoryAndShowFirstComparisonFunctions","a","b","showFirst","checkDirectoryAndShowFirst","localeCompare","getTime","multiplyer","extension","grid","createElement","preview","list","observe","childList","subtree","_modifiedToDate","String","parseInt","date","Number","_setModified","optionNames","insertBefore","otherFile","insertAfter","createContextMenu","dropdownContent","contextMenuOptions","reduce","acc","item","startsWith","button","action","text","innerText","row","toHumanSize","_modifiedStr","btoa_utf8","overlay","overlayElement","toLocaleString","ClassesMixin","hasClasses","classes","every","addClasses","removeClasses","firstColumn","lastColumn","classSorter","classUnsorted","classSorterUp","classSorterDown","header","direction","table","headers","_fbResizableTable","resizers","previousHeader","resizer","addEventHandlers","_nextHeader","addSortingIcons","columnIndexes","sortingIcon","closest","updateResizerHeight","height","offsetHeight","th","x","next_header","next_width","mousemoveEventHander","dx","clientX","mouseupEventHandler","removeEventListener","getComputedStyle","btoa","fromCharCode","TextEncoder","encode","atob_utf8","value_latin1","atob","TextDecoder","decode","Uint8Array","charCodeAt","units","unitIndex","toFixed","context","stringCallback","_","eval","isValidURL","url","URL"],"mappings":"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"}