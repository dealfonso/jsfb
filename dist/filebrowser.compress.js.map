{"version":3,"file":"filebrowser.compress.js.map","sources":["filebrowser.js"],"sourcesContent":["/**\n    MIT License\n\n    Copyright 2023 Carlos A. (https://github.com/dealfonso)\n\n    Permission is hereby granted, free of charge, to any person obtaining a copy\n    of this software and associated documentation files (the \"Software\"), to deal\n    in the Software without restriction, including without limitation the rights\n    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n    copies of the Software, and to permit persons to whom the Software is\n    furnished to do so, subject to the following conditions:\n\n    The above copyright notice and this permission notice shall be included in all\n    copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n    SOFTWARE.\n*/\n\n(function (exports) {\n\tif (typeof exports === \"undefined\") {\n\t\texports = window;\n\t}\n\tclass FBDropdown {\n\t\tstatic defaults = {\n\t\t\tcloseOnOutsideClick: true,\n\t\t\topeningSide: \"auto\",\n\t\t\topeningSideToPage: false\n\t\t};\n\t\textractOptions() {\n\t\t\tlet options = {};\n\t\t\tfor (let key in FBDropdown.defaults) {\n\t\t\t\tif (this.dropdown.dataset[key] !== undefined) {\n\t\t\t\t\toptions[key] = this.dropdown.dataset[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\tconstructor(dropdown, options = {}) {\n\t\t\tif (dropdown._fbDropdown !== undefined) {\n\t\t\t\treturn dropdown._fbDropdown;\n\t\t\t}\n\t\t\tthis.dropdown = dropdown;\n\t\t\tlet effectiveOptions = Object.assign({}, FBDropdown.defaults, this.extractOptions(), options);\n\t\t\tthis.options = effectiveOptions;\n\t\t\tthis.toggle = dropdown.querySelector(\".fb-dropdown-toggle\");\n\t\t\tthis.content = dropdown.querySelector(\".fb-dropdown-content\");\n\t\t\tthis.isOpen = false;\n\t\t\tthis.documentClickHandler = !this.options.closeOnOutsideClick ? null : event => {\n\t\t\t\tif (!this.dropdown.contains(event.target)) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.optionsInMenu = dropdown.querySelectorAll(\".fb-dropdown-content\"),\n\t\t\t\tthis.closeHandler = event => {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t};\n\t\t\tthis.toggle.addEventListener(\"click\", event => {\n\t\t\t\tthis.toggleOpen();\n\t\t\t\tevent.stopPropagation();\n\t\t\t});\n\t\t\tthis.optionsInMenu.forEach(option => {\n\t\t\t\toption.addEventListener(\"click\", this.closeHandler);\n\t\t\t});\n\t\t\tif (this.options.closeOnOutsideClick) {\n\t\t\t\tdocument.addEventListener(\"click\", this.documentClickHandler);\n\t\t\t}\n\t\t\tdropdown._fbDropdown = this;\n\t\t}\n\t\tshow() {\n\t\t\tlet openToLeft = false;\n\t\t\tswitch (this.options.openingSide) {\n\t\t\tcase \"left\":\n\t\t\t\topenToLeft = true;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\topenToLeft = false;\n\t\t\t\tbreak;\n\t\t\tcase \"auto\":\n\t\t\tdefault:\n\t\t\t\tlet parentRect;\n\t\t\t\tif (this.options.openingSideToPage) {\n\t\t\t\t\tparentRect = document.body.getBoundingClientRect();\n\t\t\t\t} else {\n\t\t\t\t\tparentRect = this.dropdown.parentElement.getBoundingClientRect();\n\t\t\t\t}\n\t\t\t\tlet buttonRect = this.toggle.getBoundingClientRect();\n\t\t\t\tthis.content.style.removeProperty(\"right\");\n\t\t\t\tthis.content.style.removeProperty(\"left\");\n\t\t\t\tthis.content.style.removeProperty(\"top\");\n\t\t\t\tthis.content.style.removeProperty(\"bottom\");\n\t\t\t\tlet rect = this.content.getBoundingClientRect();\n\t\t\t\tlet openToRightDistance = parentRect.right - (buttonRect.left + rect.width);\n\t\t\t\tlet openToLeftDistance = buttonRect.right - rect.width - parentRect.left;\n\t\t\t\tif (openToLeftDistance > openToRightDistance) {\n\t\t\t\t\topenToLeft = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (openToLeft) {\n\t\t\t\tthis.content.style.right = \"0\";\n\t\t\t}\n\t\t\tthis.content.classList.add(\"show\");\n\t\t\tthis.isOpen = true;\n\t\t}\n\t\thide() {\n\t\t\tthis.content.classList.remove(\"show\");\n\t\t\tthis.isOpen = false;\n\t\t}\n\t\ttoggleOpen() {\n\t\t\tthis.isOpen = !this.isOpen;\n\t\t\tif (this.isOpen) {\n\t\t\t\tthis.show();\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\t}\n\tFBDropdown.version = \"1.0.0\";\n\tif (typeof exports === \"undefined\") {\n\t\texports = window;\n\t}\n\tclass FileBrowser {\n\t\tstatic extensionToIcon = {\n\t\t\ttxt: \"fas fa-file-alt\",\n\t\t\tpdf: \"fas fa-file-pdf\",\n\t\t\tdoc: \"fas fa-file-word\",\n\t\t\tdocx: \"fas fa-file-word\",\n\t\t\txls: \"fas fa-file-excel\",\n\t\t\txlsx: \"fas fa-file-excel\",\n\t\t\tppt: \"fas fa-file-powerpoint\",\n\t\t\tpptx: \"fas fa-file-powerpoint\",\n\t\t\tjpg: \"fas fa-file-image\",\n\t\t\tjpeg: \"fas fa-file-image\",\n\t\t\tpng: \"fas fa-file-image\",\n\t\t\tgif: \"fas fa-file-image\",\n\t\t\tmp3: \"fas fa-file-audio\",\n\t\t\twav: \"fas fa-file-audio\",\n\t\t\tmov: \"fas fa-file-video\",\n\t\t\tmp4: \"fas fa-file-video\",\n\t\t\tavi: \"fas fa-file-video\",\n\t\t\tzip: \"fas fa-file-archive\",\n\t\t\trar: \"fas fa-file-archive\",\n\t\t\ttar: \"fas fa-file-archive\",\n\t\t\tgz: \"fas fa-file-archive\",\n\t\t\t\"7z\": \"fas fa-file-archive\",\n\t\t\texe: \"fas fa-file-executable\",\n\t\t\tjs: \"fas fa-file-code\",\n\t\t\tcss: \"fas fa-file-code\",\n\t\t\thtml: \"fas fa-file-code\",\n\t\t\tphp: \"fas fa-file-code\",\n\t\t\tpy: \"fas fa-file-code\",\n\t\t\tjava: \"fas fa-file-code\",\n\t\t\tc: \"fas fa-file-code\",\n\t\t\tcpp: \"fas fa-file-code\",\n\t\t\th: \"fas fa-file-code\",\n\t\t\thpp: \"fas fa-file-code\",\n\t\t\tjson: \"fas fa-file-code\",\n\t\t\txml: \"fas fa-file-code\",\n\t\t\tcsv: \"fas fa-file-excel\",\n\t\t\tfile: \"fas fa-file\",\n\t\t\thtml: \"fas fa-file-code\",\n\t\t\tmd: \"fas fa-file-alt\"\n\t\t};\n\t\tstatic defaultOptions = {\n\t\t\tmode: \"list\",\n\t\t\torderColumn: \"filename\",\n\t\t\torderAscending: true,\n\t\t\thideZeroSize: true,\n\t\t\tallowDuplicates: false,\n\t\t\tseparateFoldersFromFiles: true,\n\t\t\tonFileClick: file => {},\n\t\t\tonFileDoubleClick: file => {},\n\t\t\toverlayGenerator: file => null,\n\t\t\tonFileHtmlElementCreated: (element, file, mode) => {},\n\t\t\tonFileDownload: null,\n\t\t\tonFileDelete: null,\n\t\t\tonFileRename: null,\n\t\t\tonFileCopy: null,\n\t\t\tonFileMove: null,\n\t\t\tonFileShare: null,\n\t\t\tonFileInfo: null,\n\t\t\textensionToIcon: FileBrowser.extensionToIcon,\n\t\t\tcustomContextMenu: null\n\t\t};\n\t\tstatic mutationObserver = new MutationObserver(mutations => {\n\t\t\tFileBrowser.fromDOM(document.querySelectorAll(\".fb-filebrowser\"));\n\t\t});\n\t\tstatic fromDOM(objects, options = {}) {\n\t\t\tlet result = [];\n\t\t\tif (objects instanceof Element) {\n\t\t\t\tobjects = [objects];\n\t\t\t} else if (objects instanceof NodeList) {\n\t\t\t\tobjects = Array.from(objects);\n\t\t\t} else if (!Array.isArray(objects)) {\n\t\t\t\tthrow new Error(\"Invalid type of objects\");\n\t\t\t}\n\t\t\tif (objects.length === 0) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tobjects.forEach(filebrowser => {\n\t\t\t\tlet current = filebrowser._fbFileBrowser ?? null;\n\t\t\t\tif (current === null) {\n\t\t\t\t\tcurrent = new FileBrowser(filebrowser, options);\n\t\t\t\t}\n\t\t\t\tresult.push(current);\n\t\t\t});\n\t\t\tif (objects.length === 1) {\n\t\t\t\treturn result[0];\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\tconstructor(element, options = {}) {\n\t\t\tif (element instanceof Element) {} else if (typeof element === \"string\") {\n\t\t\t\telement = document.querySelector(element);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Invalid element\");\n\t\t\t}\n\t\t\tif (element._fbFileBrowser !== undefined) {\n\t\t\t\telement._fbFileBrowser.updateOptions(options);\n\t\t\t\treturn element._fbFileBrowser;\n\t\t\t}\n\t\t\tlet optionsFromDOM = FileBrowser._optionsFromDOM(element, FileBrowser.defaultOptions, \"fb\");\n\t\t\tthis.options = Object.assign({}, FileBrowser.defaultOptions, optionsFromDOM, options);\n\t\t\tthis.orderColumn = null;\n\t\t\tthis.orderAscending = null;\n\t\t\tthis.mode = null;\n\t\t\tthis.filelist = [];\n\t\t\tthis._elementsPlace = null;\n\t\t\tthis._htmlElement = element;\n\t\t\tthis._evaluateOptions();\n\t\t\telement._fbFileBrowser = this;\n\t\t\tlet files = element.querySelectorAll(\"fb-file\");\n\t\t\tlet existingFiles = Array.from(files).map(file => {\n\t\t\t\tconst basicFileInformation = {\n\t\t\t\t\tfilename: \"\",\n\t\t\t\t\tsize: 0,\n\t\t\t\t\tmodified: null,\n\t\t\t\t\tisDirectory: false,\n\t\t\t\t\ttype: \"file\",\n\t\t\t\t\tpreviewUrl: null,\n\t\t\t\t\ticon: null,\n\t\t\t\t\tdata: null\n\t\t\t\t};\n\t\t\t\tlet options = FileBrowser._optionsFromDOM(file, basicFileInformation, \"fb\");\n\t\t\t\treturn Object.assign({}, {\n\t\t\t\t\tfilename: file.textContent,\n\t\t\t\t\tsize: 0,\n\t\t\t\t\tmodified: null\n\t\t\t\t}, options);\n\t\t\t});\n\t\t\tthis.render();\n\t\t\texistingFiles.forEach(file => {\n\t\t\t\tif (file.isDirectory) {\n\t\t\t\t\tthis.addFolder(file.filename, file.modified, file);\n\t\t\t\t} else {\n\t\t\t\t\tthis.addFile(file.filename, file.size, file.modified, file);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tupdateOptions(options, fromClear = false) {\n\t\t\tif (fromClear) {\n\t\t\t\tthis.options = Object.assign({}, FileBrowser.defaultOptions, options);\n\t\t\t} else {\n\t\t\t\tthis.options = Object.assign({}, this.options, options);\n\t\t\t}\n\t\t\tthis._evaluateOptions();\n\t\t\tthis.render();\n\t\t}\n\t\tsetMode(mode) {\n\t\t\tswitch (mode.toLowerCase()) {\n\t\t\tcase \"list\":\n\t\t\tcase \"grid\":\n\t\t\tcase \"preview\":\n\t\t\t\tthis.mode = mode;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"Invalid mode\");\n\t\t\t}\n\t\t}\n\t\t_addFile(filename, options = {}) {\n\t\t\tif (!this.options.allowDuplicates) {\n\t\t\t\tlet existing = this.filelist.find(file => file.filename === filename);\n\t\t\t\tif (existing !== undefined) {\n\t\t\t\t\tthrow new Error(\"File already exists\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tfilename = `${filename}`;\n\t\t\toptions = Object.assign({}, {\n\t\t\t\tcontextMenu: this.options.customContextMenu,\n\t\t\t\ticon: options.isDirectory ? \"fa-regular fa-folder\" : this._filenameToIcon(filename),\n\t\t\t\ttype: filename.split(\".\").pop().toLowerCase(),\n\t\t\t\tonFileClick: this.options.onFileClick,\n\t\t\t\tonFileDoubleClick: this.options.onFileDoubleClick\n\t\t\t}, options);\n\t\t\tlet file = new FileInFileBrowser(filename, options);\n\t\t\tlet nextFile = this._findNextFile(file);\n\t\t\tif (nextFile !== null) {\n\t\t\t\tthis.filelist.splice(this.filelist.indexOf(nextFile), 0, file);\n\t\t\t\tthis._renderFile(file, nextFile);\n\t\t\t} else {\n\t\t\t\tthis.filelist.push(file);\n\t\t\t\tthis._renderFile(file);\n\t\t\t}\n\t\t\treturn file;\n\t\t}\n\t\taddFile(filename, size, modified, options = {}) {\n\t\t\treturn this._addFile(filename, Object.assign({}, options, {\n\t\t\t\tisDirectory: false,\n\t\t\t\tsize: size,\n\t\t\t\tmodified: modified\n\t\t\t}));\n\t\t}\n\t\taddOrUpdateFile(filename, options = {}) {\n\t\t\tlet existing = this.findFile(filename);\n\t\t\toptions = Object.assign({}, options, {\n\t\t\t\tisDirectory: false,\n\t\t\t\ttype: filename.split(\".\").pop().toLowerCase()\n\t\t\t});\n\t\t\tif (existing === null) {\n\t\t\t\treturn this.addFile(filename, 0, new Date(), options);\n\t\t\t}\n\t\t\tif (existing.isDirectory) {\n\t\t\t\tthrow new Error(\"Existing file is not a file\");\n\t\t\t}\n\t\t\texisting.update(options);\n\t\t\tthis.render();\n\t\t\treturn existing;\n\t\t}\n\t\tupdateFile(filename, options = {}) {\n\t\t\tlet existing = this.findFile(filename);\n\t\t\tif (existing === null) {\n\t\t\t\tthrow new Error(\"File not found\");\n\t\t\t}\n\t\t\treturn this.addOrUpdateFile(filename, options);\n\t\t}\n\t\taddFolder(name, modified, options = {}) {\n\t\t\treturn this._addFile(name, Object.assign({}, {\n\t\t\t\ticon: \"fa-regular fa-folder\",\n\t\t\t\tsize: null\n\t\t\t}, options, {\n\t\t\t\tisDirectory: true,\n\t\t\t\tmodified: modified\n\t\t\t}));\n\t\t}\n\t\tupdateFolder(name, options = {}) {\n\t\t\tlet existing = this.findFile(name);\n\t\t\tif (existing === null) {\n\t\t\t\tthrow new Error(\"Folder not found\");\n\t\t\t}\n\t\t\treturn this.addOrUpdateFolder(name, options);\n\t\t}\n\t\taddOrUpdateFolder(name, options = {}) {\n\t\t\toptions = Object.assign({}, options, {\n\t\t\t\tisDirectory: true,\n\t\t\t\ttype: \"folder\"\n\t\t\t});\n\t\t\tlet existing = this.findFile(name);\n\t\t\tif (existing === null) {\n\t\t\t\treturn this.addFolder(name, new Date(), options);\n\t\t\t}\n\t\t\tif (!existing.isDirectory) {\n\t\t\t\tthrow new Error(\"Existing file is not a folder\");\n\t\t\t}\n\t\t\texisting.update(options);\n\t\t\tthis.render();\n\t\t\treturn existing;\n\t\t}\n\t\tfindFile(filename) {\n\t\t\tlet existing = this.filelist.find(file => file.filename === filename);\n\t\t\tif (existing === undefined) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn existing;\n\t\t}\n\t\tfindFiles(filename) {\n\t\t\treturn this.filelist.filter(file => file.filename === filename);\n\t\t}\n\t\tremoveFile(file) {\n\t\t\tif (file instanceof FileInFileBrowser) {\n\t\t\t\tlet index = this.filelist.indexOf(file);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tthis.filelist.splice(index, 1);\n\t\t\t\t}\n\t\t\t} else if (typeof file === \"string\") {\n\t\t\t\tlet files = this.getFiles(file);\n\t\t\t\tif (files.length === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\tlet index = this.filelist.indexOf(file);\n\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\tthis.filelist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.render();\n\t\t}\n\t\tforEachFile(callback) {\n\t\t\tthis.filelist.forEach(callback);\n\t\t\tthis.render();\n\t\t}\n\t\trender(mode = null) {\n\t\t\tif (mode !== null) {\n\t\t\t\tthis.setMode(mode);\n\t\t\t}\n\t\t\tthis._htmlElement.innerHTML = \"\";\n\t\t\tlet element = null;\n\t\t\tswitch (this.mode) {\n\t\t\tcase \"list\":\n\t\t\t\telement = this._createList();\n\t\t\t\tbreak;\n\t\t\tcase \"grid\":\n\t\t\t\telement = this._createGrid();\n\t\t\t\tbreak;\n\t\t\tcase \"preview\":\n\t\t\t\telement = this._createPreview();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._renderFiles();\n\t\t\tthis._htmlElement.appendChild(element);\n\t\t\tif (this.mode === \"list\") {\n\t\t\t\tnew ResizableColumnTable(element, {\n\t\t\t\t\tsortableHeaders: true,\n\t\t\t\t\tonSort: (column, ascending) => {\n\t\t\t\t\t\tswitch (column.textContent.trim().toLowerCase()) {\n\t\t\t\t\t\tcase \"name\":\n\t\t\t\t\t\t\tthis.sort(\"filename\", ascending == \"asc\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"size\":\n\t\t\t\t\t\t\tthis.sort(\"size\", ascending == \"asc\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"modified\":\n\t\t\t\t\t\t\tthis.sort(\"modified\", ascending == \"asc\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tsort(column, ascending) {\n\t\t\tlet sortFunction = this._getSortFunction(column, ascending);\n\t\t\tthis.orderColumn = column;\n\t\t\tthis.orderAscending = ascending;\n\t\t\tthis.filelist.sort(sortFunction);\n\t\t\tthis._elementsPlace.innerHTML = \"\";\n\t\t\tthis._renderFiles();\n\t\t}\n\t\tclear() {\n\t\t\tthis.filelist = [];\n\t\t\tthis.render();\n\t\t}\n\t\tstatic _optionsFromDOM(element, defaultOptions = {}, prefix = \"fb\") {\n\t\t\tlet options = {};\n\t\t\tfor (let key in defaultOptions) {\n\t\t\t\tlet dataKey = prefix + key[0].toUpperCase() + key.slice(1);\n\t\t\t\tif (element.dataset[dataKey] !== undefined) {\n\t\t\t\t\tlet value = element.dataset[dataKey];\n\t\t\t\t\tif (value === \"true\" || value === \"false\") {\n\t\t\t\t\t\toptions[key] = value === \"true\";\n\t\t\t\t\t} else if (!isNaN(parseFloat(value)) && parseFloat(value).toString() == value) {\n\t\t\t\t\t\toptions[key] = parseFloat(value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions[key] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\t_generateContextMenu() {\n\t\t\tlet contextMenu = {};\n\t\t\tif (this.options.onFileDownload instanceof Function) {\n\t\t\t\tcontextMenu[\"download\"] = {\n\t\t\t\t\tlabel: \"Download\",\n\t\t\t\t\ticon: \"fa fa-download\",\n\t\t\t\t\thandler: this.options.onFileDownload\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileDelete instanceof Function) {\n\t\t\t\tcontextMenu[\"delete\"] = {\n\t\t\t\t\tlabel: \"Delete\",\n\t\t\t\t\ticon: \"fa fa-trash\",\n\t\t\t\t\thandler: this.options.onFileDelete\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileRename instanceof Function) {\n\t\t\t\tcontextMenu[\"rename\"] = {\n\t\t\t\t\tlabel: \"Rename\",\n\t\t\t\t\ticon: \"fa fa-edit\",\n\t\t\t\t\thandler: this.options.onFileRename\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileCopy instanceof Function) {\n\t\t\t\tcontextMenu[\"copy\"] = {\n\t\t\t\t\tlabel: \"Copy\",\n\t\t\t\t\ticon: \"fa fa-copy\",\n\t\t\t\t\thandler: this.options.onFileCopy\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileMove instanceof Function) {\n\t\t\t\tcontextMenu[\"move\"] = {\n\t\t\t\t\tlabel: \"Move\",\n\t\t\t\t\ticon: \"fa fa-arrows-alt\",\n\t\t\t\t\thandler: this.options.onFileMove\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileShare instanceof Function) {\n\t\t\t\tcontextMenu[\"share\"] = {\n\t\t\t\t\tlabel: \"Share\",\n\t\t\t\t\ticon: \"fa fa-share-alt\",\n\t\t\t\t\thandler: this.options.onFileShare\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (this.options.onFileInfo instanceof Function) {\n\t\t\t\tcontextMenu[\"info\"] = {\n\t\t\t\t\tlabel: \"Info\",\n\t\t\t\t\ticon: \"fa fa-info\",\n\t\t\t\t\thandler: this.options.onFileInfo\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (Object.keys(contextMenu).length > 0) {\n\t\t\t\tcontextMenu.__generated = true;\n\t\t\t\treturn contextMenu;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t_evaluateOptions() {\n\t\t\tthis.orderColumn = this.options.orderColumn;\n\t\t\tthis.orderAscending = this.options.orderAscending;\n\t\t\tthis.setMode(this.options.mode);\n\t\t\tthis.options.onFileHtmlElementCreated = this.options.onFileHtmlElementCreated?.bind(this);\n\t\t\tlet callbacks = [\"onFileClick\", \"onFileDoubleClick\", \"onFileDownload\", \"onFileDelete\", \"onFileRename\", \"onFileCopy\", \"onFileMove\", \"onFileShare\", \"onFileInfo\"];\n\t\t\tcallbacks.forEach(callback => {\n\t\t\t\tthis.options[callback] = covertCallback(this.options[callback], this);\n\t\t\t});\n\t\t\tif (this.options.customContextMenu === null || this.options.customContextMenu.__generated) {\n\t\t\t\tthis.options.customContextMenu = this._generateContextMenu();\n\t\t\t}\n\t\t\tif ((this.options.extensionToIcon ?? null) === null) {\n\t\t\t\tthis.options.extensionToIcon = {};\n\t\t\t}\n\t\t\tif (typeof this.options.extensionToIcon !== \"object\") {\n\t\t\t\tthrow new Error(\"Invalid extensionToIcon\");\n\t\t\t}\n\t\t}\n\t\t_renderFile(file, nextFile = null) {\n\t\t\tlet element = null;\n\t\t\tswitch (this.mode) {\n\t\t\tcase \"list\":\n\t\t\t\telement = file.tableRow();\n\t\t\t\tbreak;\n\t\t\tcase \"grid\":\n\t\t\t\telement = file.gridElement(this.options.overlayGenerator);\n\t\t\t\tbreak;\n\t\t\tcase \"preview\":\n\t\t\t\telement = file.previewElement(this.options.overlayGenerator);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (this.options.hideZeroSize && file.size === 0) {\n\t\t\t\telement.querySelector(\".fb-file-size\").innerHTML = \"\";\n\t\t\t}\n\t\t\tthis.options.onFileHtmlElementCreated?.call(this, element, file, this.mode);\n\t\t\tif (nextFile !== null) {\n\t\t\t\tnextFile._htmlElement.insertAdjacentElement(\"beforebegin\", element);\n\t\t\t} else {\n\t\t\t\tthis._elementsPlace.appendChild(element);\n\t\t\t}\n\t\t}\n\t\t_getDirectoryAndShowFirstComparisonFunctions() {\n\t\t\tif (this.options.separateFoldersFromFiles) {\n\t\t\t\treturn function (a, b) {\n\t\t\t\t\tif (a.isDirectory && !b.isDirectory) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (!a.isDirectory && b.isDirectory) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (a.showFirst && !b.showFirst) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (!a.showFirst && b.showFirst) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn function (a, b) {\n\t\t\t\t\tif (a.showFirst && !b.showFirst) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (!a.showFirst && b.showFirst) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t_getSortFunction(column = null, ascending = null) {\n\t\t\tif (column === null) {\n\t\t\t\tcolumn = this.orderColumn;\n\t\t\t}\n\t\t\tif (ascending === null) {\n\t\t\t\tascending = this.orderAscending;\n\t\t\t}\n\t\t\tlet sortFunction = null;\n\t\t\tlet checkDirectoryAndShowFirst = this._getDirectoryAndShowFirstComparisonFunctions();\n\t\t\tswitch (column) {\n\t\t\tcase \"filename\":\n\t\t\t\tsortFunction = (a, b) => a.filename.localeCompare(b.filename);\n\t\t\t\tbreak;\n\t\t\tcase \"size\":\n\t\t\t\tsortFunction = (a, b) => a.size - b.size;\n\t\t\t\tbreak;\n\t\t\tcase \"modified\":\n\t\t\t\tsortFunction = (a, b) => {\n\t\t\t\t\tif (a.modified === null) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (b.modified === null) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.modified.getTime() - b.modified.getTime();\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase \"type\":\n\t\t\t\tsortFunction = (a, b) => a.type.localeCompare(b.type);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"Invalid column\");\n\t\t\t}\n\t\t\tlet multiplyer = ascending ? 1 : -1;\n\t\t\treturn (a, b) => {\n\t\t\t\tlet result = checkDirectoryAndShowFirst(a, b);\n\t\t\t\tif (result !== 0) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\treturn multiplyer * sortFunction(a, b);\n\t\t\t};\n\t\t}\n\t\t_findNextFile(file) {\n\t\t\tlet sortFunction = this._getSortFunction();\n\t\t\tif (this.filelist.length == 0) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tfor (let i = 0; i < this.filelist.length; i++) {\n\t\t\t\tif (sortFunction(file, this.filelist[i]) < 0) {\n\t\t\t\t\treturn this.filelist[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t_filenameToIcon(filename) {\n\t\t\tlet extension = filename.split(\".\").pop().toLowerCase();\n\t\t\tif (this.options.extensionToIcon instanceof Function) {\n\t\t\t\treturn this.options.extensionToIcon(extension);\n\t\t\t}\n\t\t\tif (extension in this.options.extensionToIcon) {\n\t\t\t\treturn this.options.extensionToIcon[extension];\n\t\t\t}\n\t\t\treturn this.options.extensionToIcon[\"\"] || \"fa fa-file\";\n\t\t}\n\t\t_createGrid() {\n\t\t\tlet grid = document.createElement(\"div\");\n\t\t\tgrid.classList.add(\"fb-grid\");\n\t\t\tthis._elementsPlace = grid;\n\t\t\treturn grid;\n\t\t}\n\t\t_createPreview() {\n\t\t\tlet preview = document.createElement(\"div\");\n\t\t\tpreview.classList.add(\"fb-preview\");\n\t\t\tthis._elementsPlace = preview;\n\t\t\treturn preview;\n\t\t}\n\t\t_createList() {\n\t\t\tlet list = document.createElement(\"div\");\n\t\t\tlist.classList.add(\"fb-list\");\n\t\t\tlist.innerHTML = `\n        <table>\n            <thead>\n                <tr>\n                    <th class=\"fb-file-name\">Name</th>\n                    <th class=\"fb-file-size\">Size</th>\n                    <th class=\"fb-file-modified\">Modified</th>\n                </tr>\n            </thead>\n            <tbody></tbody>\n        </table>\n        `;\n\t\t\tthis._elementsPlace = list.querySelector(\"tbody\");\n\t\t\treturn list;\n\t\t}\n\t\t_renderFiles() {\n\t\t\tthis.filelist.forEach(file => {\n\t\t\t\tthis._renderFile(file);\n\t\t\t});\n\t\t}\n\t}\n\tdocument.addEventListener(\"DOMContentLoaded\", () => {\n\t\tFileBrowser.mutationObserver.observe(document.body, {\n\t\t\tchildList: true,\n\t\t\tsubtree: true\n\t\t});\n\t\tFileBrowser.fromDOM(document.querySelectorAll(\".fb-filebrowser\"));\n\t});\n\texports.FileBrowser = FileBrowser;\n\tif (typeof exports === \"undefined\") {\n\t\texports = window;\n\t}\n\tclass FileInFileBrowser {\n\t\tstatic defaultOptions = {\n\t\t\tsize: 0,\n\t\t\tmodified: null,\n\t\t\ticon: \"fa fa-file\",\n\t\t\ttype: \"file\",\n\t\t\tisDirectory: false,\n\t\t\tshowFirst: false,\n\t\t\tpreviewUrl: null,\n\t\t\tonFileClick: null,\n\t\t\tonFileDoubleClick: null,\n\t\t\tdata: null,\n\t\t\tcontextMenu: null\n\t\t};\n\t\tconstructor(filename, options = {}) {\n\t\t\toptions = Object.assign({}, FileInFileBrowser.defaultOptions, options);\n\t\t\tthis.update(options);\n\t\t\tthis.filename = filename;\n\t\t\tthis.selected = false;\n\t\t\tthis._htmlElement = null;\n\t\t}\n\t\t_setModified(modified) {\n\t\t\tif (modified === null) {\n\t\t\t\tthis.modified = null;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof modified === \"string\" || modified instanceof String) {\n\t\t\t\tif (!isNaN(modified)) {\n\t\t\t\t\tmodified = parseInt(modified);\n\t\t\t\t} else {\n\t\t\t\t\tlet date = new Date(modified);\n\t\t\t\t\tif (date.toString() !== \"Invalid Date\") {\n\t\t\t\t\t\tmodified = date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof modified === \"number\" || modified instanceof Number) {\n\t\t\t\tlet date = new Date(modified);\n\t\t\t\tif (date.toString() !== \"Invalid Date\") {\n\t\t\t\t\tmodified = date;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (modified instanceof Date) {\n\t\t\t\tthis.modified = modified;\n\t\t\t}\n\t\t}\n\t\tupdate(options = {}) {\n\t\t\tlet optionNames = Object.keys(FileInFileBrowser.defaultOptions);\n\t\t\tfor (let option of optionNames) {\n\t\t\t\tif (options[option] !== undefined) {\n\t\t\t\t\tswitch (option) {\n\t\t\t\t\tcase \"modified\":\n\t\t\t\t\t\tthis._setModified(options[option]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis[option] = options[option];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.previewUrl !== null) {\n\t\t\t\tif (!isValidURL(this.previewUrl)) {\n\t\t\t\t\tthis.previewUrl = null;\n\t\t\t\t\tconsole.warn(\"The preview URL is not valid\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.isDirectory = options.isDirectory ?? false;\n\t\t}\n\t\tselect() {\n\t\t\tthis.selected = true;\n\t\t\tif (this._htmlElement) {\n\t\t\t\tthis._htmlElement.classList.add(\"selected\");\n\t\t\t}\n\t\t}\n\t\tunselect() {\n\t\t\tthis.selected = false;\n\t\t\tif (this._htmlElement) {\n\t\t\t\tthis._htmlElement.classList.remove(\"selected\");\n\t\t\t}\n\t\t}\n\t\ttoggleSelect() {\n\t\t\tif (this.selected) {\n\t\t\t\tthis.unselect();\n\t\t\t} else {\n\t\t\t\tthis.select();\n\t\t\t}\n\t\t}\n\t\tinsertBefore(otherFile) {\n\t\t\tif (this._htmlElement !== null && otherFile._htmlElement !== null) {\n\t\t\t\totherFile._htmlElement.insertAdjacentElement(\"beforebegin\", this._htmlElement);\n\t\t\t}\n\t\t}\n\t\tinsertAfter(otherFile) {\n\t\t\tif (this._htmlElement !== null && otherFile._htmlElement !== null) {\n\t\t\t\totherFile._htmlElement.insertAdjacentElement(\"afterend\", this._htmlElement);\n\t\t\t}\n\t\t}\n\t\tcreateContextMenu() {\n\t\t\tif (this.contextMenu === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tlet contextMenu = document.createElement(\"div\");\n\t\t\tcontextMenu.classList.add(\"fb-dropdown\", \"fb-dropdown-s\", \"fb-file-context-menu\");\n\t\t\tcontextMenu.innerHTML = `\n            <button class=\"fb-dropdown-toggle\" type=\"button\">\n                <i class=\"fa fa-ellipsis-v\"></i>\n            </button>`;\n\t\t\tlet dropdownContent = document.createElement(\"ul\");\n\t\t\tdropdownContent.classList.add(\"fb-dropdown-content\");\n\t\t\tlet contextMenuOptions = this.contextMenu;\n\t\t\tif (contextMenuOptions instanceof Array) {\n\t\t\t\tcontextMenuOptions = contextMenuOptions.reduce((acc, item) => {\n\t\t\t\t\tacc[item] = {};\n\t\t\t\t\treturn acc;\n\t\t\t\t}, {});\n\t\t\t}\n\t\t\tfor (let option in contextMenuOptions) {\n\t\t\t\tif (option.startsWith(\"__\")) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet item = document.createElement(\"li\");\n\t\t\t\tlet button = document.createElement(\"button\");\n\t\t\t\tbutton.type = \"button\";\n\t\t\t\tbutton.dataset.action = option;\n\t\t\t\tlet text = contextMenuOptions[option].label ?? option;\n\t\t\t\tif (contextMenuOptions[option].icon) {\n\t\t\t\t\tbutton.innerHTML = `<i class=\"${contextMenuOptions[option].icon}\"></i> ${text}`;\n\t\t\t\t} else {\n\t\t\t\t\tbutton.innerText = text;\n\t\t\t\t}\n\t\t\t\tlet handler = contextMenuOptions[option].handler ?? contextMenuOptions[option];\n\t\t\t\tif (handler instanceof Function) {\n\t\t\t\t\tbutton.addEventListener(\"click\", file => {\n\t\t\t\t\t\thandler(this);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\titem.appendChild(button);\n\t\t\t\tdropdownContent.appendChild(item);\n\t\t\t}\n\t\t\tcontextMenu.appendChild(dropdownContent);\n\t\t\tnew FBDropdown(contextMenu, {\n\t\t\t\tcloseOnOutsideClick: true\n\t\t\t});\n\t\t\treturn contextMenu;\n\t\t}\n\t\ttableRow() {\n\t\t\tif (this._htmlElement !== null) {\n\t\t\t\tthis._htmlElement.remove();\n\t\t\t}\n\t\t\tlet row = document.createElement(\"tr\");\n\t\t\trow.innerHTML = `\n            <td class=\"fb-file-name\"><span class=\"fb-file-icon\"><i class=\"${this.icon}\"></i></span> ${this.filename}</td>\n            <td class=\"fb-file-size\">${toHumanSize(this.size)}</td>\n            <td class=\"fb-file-modified\">${this._modifiedStr()}</td>\n        `;\n\t\t\trow.dataset.filename = btoa_utf8(this.filename);\n\t\t\trow.dataset.size = this.size;\n\t\t\trow.dataset.modified = this.modified?.getTime();\n\t\t\trow.dataset.type = this.type;\n\t\t\tif (this.selected) {\n\t\t\t\trow.classList.add(\"selected\");\n\t\t\t}\n\t\t\trow.addEventListener(\"click\", () => {\n\t\t\t\tif (this.onFileClick instanceof Function) {\n\t\t\t\t\tthis.onFileClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\trow.addEventListener(\"dblclick\", () => {\n\t\t\t\tif (this.onFileDoubleClick instanceof Function) {\n\t\t\t\t\tthis.onFileDoubleClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (this.selected) {\n\t\t\t\trow.classList.add(\"selected\");\n\t\t\t}\n\t\t\tthis._htmlElement = row;\n\t\t\treturn this._htmlElement;\n\t\t}\n\t\tpreviewElement(overlayGenerator = null) {\n\t\t\tif (this._htmlElement !== null) {\n\t\t\t\tthis._htmlElement.remove();\n\t\t\t}\n\t\t\tlet overlay = null;\n\t\t\tif (overlayGenerator instanceof Function) {\n\t\t\t\toverlay = overlayGenerator(this);\n\t\t\t}\n\t\t\tlet contextMenu = this.createContextMenu();\n\t\t\tlet element = document.createElement(\"div\");\n\t\t\telement.classList.add(\"fb-file-wrapper\");\n\t\t\telement.innerHTML = `\n            <div class=\"fb-file\">\n            </div>\n        `;\n\t\t\tlet previewElement = element.querySelector(\".fb-file\");\n\t\t\tif (this.previewUrl !== null) {\n\t\t\t\tpreviewElement.innerHTML = `\n                <div class=\"fb-preview-image\">\n                    <div class=\"fb-preview-image-background\" style=\"background-image: url('${this.previewUrl}')\"></div>\n                    <div class=\"fb-preview-image-image\" style=\"background-image: url('${this.previewUrl}')\"></div>\n                </div>\n            `;\n\t\t\t} else {\n\t\t\t\tpreviewElement.innerHTML = `\n                <div class=\"fb-file-icon\">\n                    <i class=\"${this.icon}\"></i>\n                </div>`;\n\t\t\t}\n\t\t\tpreviewElement.innerHTML += `\n                <div class=\"fb-file-details\">\n                    <p class=\"fb-file-name\">${this.filename}</p>\n                    <p class=\"fb-file-size\">${toHumanSize(this.size)}</p>\n                    <p class=\"fb-file-modified\">${this._modifiedStr()}</p>\n                </div>\n        `;\n\t\t\tif (overlay !== null || contextMenu !== null) {\n\t\t\t\tlet overlayElement = document.createElement(\"div\");\n\t\t\t\toverlayElement.classList.add(\"fb-preview-overlay\");\n\t\t\t\tif (overlay !== null) {\n\t\t\t\t\toverlayElement.appendChild(overlay);\n\t\t\t\t}\n\t\t\t\tif (contextMenu !== null) {\n\t\t\t\t\toverlayElement.appendChild(contextMenu);\n\t\t\t\t}\n\t\t\t\telement.appendChild(overlayElement);\n\t\t\t}\n\t\t\telement.dataset.filename = btoa_utf8(this.filename);\n\t\t\telement.dataset.size = this.size;\n\t\t\telement.dataset.modified = this.modified?.getTime();\n\t\t\telement.dataset.type = this.type;\n\t\t\tif (this.selected) {\n\t\t\t\telement.classList.add(\"selected\");\n\t\t\t}\n\t\t\tthis._htmlElement = element;\n\t\t\telement.addEventListener(\"click\", () => {\n\t\t\t\tif (this.onFileClick instanceof Function) {\n\t\t\t\t\tthis.onFileClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.addEventListener(\"dblclick\", () => {\n\t\t\t\tif (this.onFileDoubleClick instanceof Function) {\n\t\t\t\t\tthis.onFileDoubleClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn this._htmlElement;\n\t\t}\n\t\t_modifiedStr() {\n\t\t\treturn this.modified === null || this.modified === undefined ? \"\" : this.modified.toLocaleString();\n\t\t}\n\t\tgridElement(overlayGenerator = null) {\n\t\t\tif (this._htmlElement !== null) {\n\t\t\t\tthis._htmlElement.remove();\n\t\t\t}\n\t\t\tlet overlay = null;\n\t\t\tif (overlayGenerator instanceof Function) {\n\t\t\t\toverlay = overlayGenerator(this);\n\t\t\t}\n\t\t\tlet contextMenu = this.createContextMenu();\n\t\t\tlet element = document.createElement(\"div\");\n\t\t\telement.classList.add(\"fb-file-wrapper\");\n\t\t\telement.innerHTML = `\n            <div class=\"fb-file\">\n                <div class=\"fb-file-icon\">\n                    <i class=\"${this.icon}\"></i>\n                </div>\n                <div class=\"fb-file-details\" title=\"${this.filename}\">\n                    <p class=\"fb-file-name\">${this.filename}</p>\n                    <p class=\"fb-file-size\">${toHumanSize(this.size)}</p>\n                    <p class=\"fb-file-modified\">${this._modifiedStr()}</p>\n                </div>\n            </div>\n        `;\n\t\t\tif (overlay !== null || contextMenu !== null) {\n\t\t\t\tlet overlayElement = document.createElement(\"div\");\n\t\t\t\toverlayElement.classList.add(\"fb-file-overlay\");\n\t\t\t\tif (overlay !== null) {\n\t\t\t\t\toverlayElement.appendChild(overlay);\n\t\t\t\t}\n\t\t\t\tif (contextMenu !== null) {\n\t\t\t\t\toverlayElement.appendChild(contextMenu);\n\t\t\t\t}\n\t\t\t\telement.appendChild(overlayElement);\n\t\t\t}\n\t\t\telement.dataset.filename = btoa_utf8(this.filename);\n\t\t\telement.dataset.size = this.size;\n\t\t\telement.dataset.modified = this.modified?.getTime();\n\t\t\telement.dataset.type = this.type;\n\t\t\tif (this.selected) {\n\t\t\t\telement.classList.add(\"selected\");\n\t\t\t}\n\t\t\tthis._htmlElement = element;\n\t\t\telement.addEventListener(\"click\", () => {\n\t\t\t\tif (this.onFileClick instanceof Function) {\n\t\t\t\t\tthis.onFileClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.addEventListener(\"dblclick\", () => {\n\t\t\t\tif (this.onFileDoubleClick instanceof Function) {\n\t\t\t\t\tthis.onFileDoubleClick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn this._htmlElement;\n\t\t}\n\t}\n\texports.FileInFileBrowser = FileInFileBrowser;\n\tconst ClassesMixin = {\n\t\thasClasses: function (classes) {\n\t\t\tif (typeof classes === \"string\") {\n\t\t\t\tclasses = classes.split(\" \").map(c => c.trim()).filter(c => c.length > 0);\n\t\t\t}\n\t\t\tif (!Array.isArray(classes)) {\n\t\t\t\tthrow new Error(\"Classes must be an array or a string\");\n\t\t\t}\n\t\t\treturn classes.every(c => this.classList.contains(c));\n\t\t},\n\t\taddClasses: function (classes) {\n\t\t\tif (typeof classes === \"string\") {\n\t\t\t\tclasses = classes.split(\" \").map(c => c.trim()).filter(c => c.length > 0);\n\t\t\t}\n\t\t\tif (!Array.isArray(classes)) {\n\t\t\t\tthrow new Error(\"Classes must be an array or a string\");\n\t\t\t}\n\t\t\tclasses.forEach(c => this.classList.add(c));\n\t\t},\n\t\tremoveClasses: function (classes) {\n\t\t\tif (typeof classes === \"string\") {\n\t\t\t\tclasses = classes.split(\" \").map(c => c.trim()).filter(c => c.length > 0);\n\t\t\t}\n\t\t\tif (!Array.isArray(classes)) {\n\t\t\t\tthrow new Error(\"Classes must be an array or a string\");\n\t\t\t}\n\t\t\tclasses.forEach(c => this.classList.remove(c));\n\t\t}\n\t};\n\tclass ResizableColumnTable {\n\t\tstatic defaultOptions = {\n\t\t\tfirstColumn: 0,\n\t\t\tlastColumn: -1,\n\t\t\tsortableHeaders: true,\n\t\t\tclassSorter: \"sorter fas\",\n\t\t\tclassUnsorted: \"fa-sort\",\n\t\t\tclassSorterUp: \"up fa-sort-up\",\n\t\t\tclassSorterDown: \"down fa-sort-down\",\n\t\t\tonSort: (header, direction) => {}\n\t\t};\n\t\tconstructor(table, options = {}) {\n\t\t\tthis.options = Object.assign({}, ResizableColumnTable.defaultOptions, options);\n\t\t\tlet headers = table.querySelectorAll(\"th\");\n\t\t\tif (this.options.lastColumn < 0) {\n\t\t\t\tthis.options.lastColumn = headers.length + this.options.lastColumn;\n\t\t\t}\n\t\t\tif (this.options.lastColumn < 0 || this.options.lastColumn >= headers.length) {\n\t\t\t\tthrow new Error(\"Last column is invalid\");\n\t\t\t}\n\t\t\tif (this.options.firstColumn > this.options.lastColumn) {\n\t\t\t\tthrow new Error(\"First column is greater than last column\");\n\t\t\t}\n\t\t\tthis.table = table;\n\t\t\tthis.table._fbResizableTable = this;\n\t\t\tthis.headers = headers;\n\t\t\tthis.resizers = [];\n\t\t\tlet previousHeader = null;\n\t\t\tfor (let i = this.options.firstColumn; i < this.options.lastColumn + 1; i++) {\n\t\t\t\tlet header = headers[i];\n\t\t\t\tlet resizer = document.createElement(\"div\");\n\t\t\t\tresizer.classList.add(\"fb-resizer\");\n\t\t\t\theader.appendChild(resizer);\n\t\t\t\tthis.resizers.push(resizer);\n\t\t\t\tthis.addEventHandlers(header, resizer);\n\t\t\t\tif (previousHeader != null) {\n\t\t\t\t\tpreviousHeader._nextHeader = header;\n\t\t\t\t}\n\t\t\t\tpreviousHeader = header;\n\t\t\t}\n\t\t\tif (previousHeader != null && previousHeader != headers[headers.length - 1]) {\n\t\t\t\tpreviousHeader._nextHeader = headers[headers.length - 1];\n\t\t\t}\n\t\t\tif (this.options.sortableHeaders) {\n\t\t\t\tthis.addSortingIcons();\n\t\t\t}\n\t\t}\n\t\taddSortingIcons() {\n\t\t\tlet columnIndexes = [];\n\t\t\tif (!Array.isArray(this.options.sortableHeaders)) {\n\t\t\t\tif (this.options.sortableHeaders === true) {\n\t\t\t\t\tcolumnIndexes = Array.from(this.headers).map((header, index) => index);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcolumnIndexes = this.options.sortableHeaders.filter(index => index >= 0 && index < this.headers.length);\n\t\t\t}\n\t\t\tcolumnIndexes.forEach(index => {\n\t\t\t\tlet header = this.headers[index];\n\t\t\t\tlet sortingIcon = document.createElement(\"i\");\n\t\t\t\tObject.assign(sortingIcon, ClassesMixin);\n\t\t\t\tsortingIcon.addClasses(this.options.classSorter);\n\t\t\t\tsortingIcon.addClasses(this.options.classUnsorted);\n\t\t\t\theader.addEventListener(\"click\", event => {\n\t\t\t\t\theader.closest(\"thead\").querySelectorAll(\".sorter\").forEach(icon => {\n\t\t\t\t\t\tif (icon != sortingIcon) {\n\t\t\t\t\t\t\ticon.removeClasses(this.options.classSorterUp);\n\t\t\t\t\t\t\ticon.removeClasses(this.options.classSorterDown);\n\t\t\t\t\t\t\ticon.addClasses(this.options.classUnsorted);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (sortingIcon.hasClasses(this.options.classSorterUp)) {\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classUnsorted);\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classSorterUp);\n\t\t\t\t\t\tsortingIcon.addClasses(this.options.classSorterDown);\n\t\t\t\t\t} else if (sortingIcon.hasClasses(this.options.classSorterDown)) {\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classUnsorted);\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classSorterDown);\n\t\t\t\t\t\tsortingIcon.addClasses(this.options.classSorterUp);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classUnsorted);\n\t\t\t\t\t\tsortingIcon.addClasses(this.options.classSorterUp);\n\t\t\t\t\t\tsortingIcon.removeClasses(this.options.classSorterDown);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.options.onSort instanceof Function) {\n\t\t\t\t\t\tthis.options.onSort(header, sortingIcon.hasClasses(this.options.classSorterUp) ? \"asc\" : \"desc\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\theader.appendChild(sortingIcon);\n\t\t\t});\n\t\t}\n\t\tupdateResizerHeight() {\n\t\t\tthis.resizers.forEach(resizer => {\n\t\t\t\tresizer.style.height = this.table.offsetHeight + \"px\";\n\t\t\t});\n\t\t}\n\t\taddEventHandlers(th, resizer) {\n\t\t\tlet x = 0;\n\t\t\tlet width = 0;\n\t\t\tlet next_header = null;\n\t\t\tlet next_width = 0;\n\t\t\tlet mousemoveEventHander = event => {\n\t\t\t\tlet dx = event.clientX - x;\n\t\t\t\tif (width + dx < 20) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (next_header != null) {\n\t\t\t\t\tnext_header.style.width = next_width - dx + \"px\";\n\t\t\t\t\tif (next_width - dx < 20) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tth.style.width = width + dx + \"px\";\n\t\t\t};\n\t\t\tlet mouseupEventHandler = () => {\n\t\t\t\tdocument.removeEventListener(\"mousemove\", mousemoveEventHander);\n\t\t\t\tdocument.removeEventListener(\"mouseup\", mouseupEventHandler);\n\t\t\t\tth.classList.remove(\"resizing\");\n\t\t\t\tth._nextHeader?.classList.remove(\"resizing\");\n\t\t\t\tresizer.classList.remove(\"resizing\");\n\t\t\t};\n\t\t\tresizer.addEventListener(\"mousedown\", event => {\n\t\t\t\tx = event.clientX;\n\t\t\t\twidth = parseInt(window.getComputedStyle(th).width, 10);\n\t\t\t\tnext_header = th._nextHeader ?? null;\n\t\t\t\tif (next_header != null) {\n\t\t\t\t\tnext_width = parseInt(window.getComputedStyle(next_header).width, 10);\n\t\t\t\t}\n\t\t\t\tdocument.addEventListener(\"mousemove\", mousemoveEventHander);\n\t\t\t\tdocument.addEventListener(\"mouseup\", mouseupEventHandler);\n\t\t\t\tth.classList.add(\"resizing\");\n\t\t\t\tth._nextHeader?.classList.add(\"resizing\");\n\t\t\t\tresizer.classList.add(\"resizing\");\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction btoa_utf8(value) {\n\t\treturn btoa(String.fromCharCode(...new TextEncoder(\"utf-8\").encode(value)));\n\t}\n\n\tfunction atob_utf8(value) {\n\t\tconst value_latin1 = atob(value);\n\t\treturn new TextDecoder(\"utf-8\").decode(Uint8Array.from({\n\t\t\tlength: value_latin1.length\n\t\t}, (element, index) => value_latin1.charCodeAt(index)));\n\t}\n\n\tfunction toHumanSize(size) {\n\t\tif (size === null || size === undefined) {\n\t\t\treturn \"\";\n\t\t}\n\t\tconst units = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\tlet unitIndex = 0;\n\t\tsize = parseFloat(size);\n\t\tif (isNaN(size)) {\n\t\t\treturn \"0 B\";\n\t\t}\n\t\twhile (size >= 1024 && unitIndex < units.length - 1) {\n\t\t\tsize /= 1024;\n\t\t\tunitIndex++;\n\t\t}\n\t\treturn `${size.toFixed(2)} ${units[unitIndex]}`;\n\t}\n\n\tfunction covertCallback(callback, context = null) {\n\t\tif (callback === null) {\n\t\t\treturn null;\n\t\t}\n\t\tif (typeof callback === \"string\") {\n\t\t\tlet stringCallback = callback;\n\t\t\tcallback = _ => {\n\t\t\t\tconst file = _;\n\t\t\t\teval(stringCallback);\n\t\t\t};\n\t\t}\n\t\tif (callback instanceof Function) {\n\t\t\tif (context !== null) {\n\t\t\t\treturn callback.bind(context);\n\t\t\t}\n\t\t\treturn callback;\n\t\t}\n\t\tthrow new Error(\"Invalid callback\");\n\t}\n\n\tfunction isValidURL(url) {\n\t\tif (url instanceof URL) {\n\t\t\treturn true;\n\t\t}\n\t\ttry {\n\t\t\tnew URL(url);\n\t\t\treturn true;\n\t\t} catch (_) {\n\t\t\treturn false;\n\t\t}\n\t}\n})(window);\n"],"names":["exports","window","FBDropdown","defaults","closeOnOutsideClick","openingSide","openingSideToPage","extractOptions","let","key","options","undefined","this","dropdown","dataset","constructor","_fbDropdown","effectiveOptions","Object","assign","toggle","querySelector","content","isOpen","documentClickHandler","event","contains","target","hide","optionsInMenu","querySelectorAll","closeHandler","stopPropagation","addEventListener","toggleOpen","forEach","option","document","show","openToLeft","parentRect","body","parentElement","getBoundingClientRect","buttonRect","rect","style","removeProperty","right","left","width","classList","add","remove","version","FileBrowser","extensionToIcon","txt","pdf","doc","docx","xls","xlsx","ppt","pptx","jpg","jpeg","png","gif","mp3","wav","mov","mp4","avi","zip","rar","tar","gz","7z","exe","js","css","html","php","py","java","c","cpp","h","hpp","json","xml","csv","file","md","defaultOptions","mode","orderColumn","orderAscending","hideZeroSize","allowDuplicates","separateFoldersFromFiles","onFileClick","onFileDoubleClick","overlayGenerator","onFileHtmlElementCreated","element","onFileDownload","onFileDelete","onFileRename","onFileCopy","onFileMove","onFileShare","onFileInfo","customContextMenu","mutationObserver","MutationObserver","mutations","fromDOM","objects","result","Element","NodeList","Array","from","isArray","Error","length","filebrowser","current","_fbFileBrowser","push","updateOptions","optionsFromDOM","_optionsFromDOM","files","filelist","_elementsPlace","_htmlElement","_evaluateOptions","existingFiles","map","filename","size","modified","isDirectory","type","previewUrl","icon","data","textContent","render","addFolder","addFile","fromClear","setMode","toLowerCase","_addFile","find","contextMenu","_filenameToIcon","split","pop","FileInFileBrowser","nextFile","_findNextFile","splice","indexOf","_renderFile","addOrUpdateFile","existing","findFile","Date","update","updateFile","name","updateFolder","addOrUpdateFolder","findFiles","filter","removeFile","index","getFiles","forEachFile","callback","innerHTML","_createList","_createGrid","_createPreview","_renderFiles","appendChild","ResizableColumnTable","sortableHeaders","onSort","column","ascending","trim","sort","sortFunction","_getSortFunction","clear","prefix","dataKey","toUpperCase","slice","value","isNaN","parseFloat","toString","_generateContextMenu","Function","label","handler","keys","__generated","bind","covertCallback","tableRow","gridElement","previewElement","call","insertAdjacentElement","_getDirectoryAndShowFirstComparisonFunctions","a","b","showFirst","checkDirectoryAndShowFirst","localeCompare","getTime","multiplyer","i","extension","grid","createElement","preview","list","observe","childList","subtree","selected","_setModified","date","String","parseInt","Number","isValidURL","console","warn","select","unselect","toggleSelect","insertBefore","otherFile","insertAfter","createContextMenu","dropdownContent","contextMenuOptions","reduce","acc","item","startsWith","button","text","action","innerText","row","toHumanSize","_modifiedStr","btoa_utf8","overlay","overlayElement","toLocaleString","ClassesMixin","hasClasses","classes","every","addClasses","removeClasses","firstColumn","lastColumn","classSorter","classUnsorted","classSorterUp","classSorterDown","header","direction","table","headers","_fbResizableTable","resizers","previousHeader","resizer","addEventHandlers","_nextHeader","addSortingIcons","columnIndexes","sortingIcon","closest","updateResizerHeight","height","offsetHeight","th","x","next_header","next_width","mousemoveEventHander","dx","clientX","mouseupEventHandler","removeEventListener","getComputedStyle","btoa","fromCharCode","TextEncoder","encode","atob_utf8","value_latin1","atob","TextDecoder","decode","Uint8Array","charCodeAt","units","unitIndex","toFixed","context","stringCallback","_","eval","url","URL"],"mappings":"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"}